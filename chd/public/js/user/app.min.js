"use strict";function syncPosition(e){var r=e.item.count-1,t=Math.round(e.item.index-e.item.count/2-.5);t<0&&(t=r),t>r&&(t=0);var o=angular.element("#sync2");o.find(".owl-item").removeClass("current").eq(t).addClass("current");var a=o.find(".owl-item.active").length-1,s=o.find(".owl-item.active").first().index(),n=o.find(".owl-item.active").last().index();t>n&&o.data("owl.carousel").to(t,100,!0),t<s&&o.data("owl.carousel").to(t-a,100,!0)}function syncPosition2(e){var r=e.item.index,t=angular.element("#sync1");t.data("owl.carousel").to(r,100,!0)}angular.module("cherrydoor",["ngMaterial","ngAnimate","ngSanitize","app.routes","app.config","app.controllers","app.directives","app.factories","app.filters","ngMessages","LocalStorageModule","ui.bootstrap","ngMap","ngScrollbars","ngImgCrop","ngFileUpload","fancyboxplus","angular-intro"]),angular.module("app.controllers",[]),angular.module("app.factories",[]),angular.module("app.directives",[]),angular.module("app.filters",[]),angular.module("app.factories").factory("CommanSrv",["$location","$rootScope",function(e,r){return{getHeaderColor:function(){return"/"!==e.path()},navbarLinks:function(){var e=r.user&&"landlord"===r.user.role?"/property-room-details":"/landload-intro",t=r.user?"/my-cherrydoor/details":"/login";return[{url:"/property-sale",icon:"account_balance",text:"For Sale"},{url:"/property-rent",icon:"home",text:"For Rent"},{url:"",icon:"person",text:"Student Rental"},{url:"/professional-trades",icon:"person_outline",text:"Professional Trades"},{url:"",icon:"share",text:"Share"},{url:"",icon:"check_circle",text:"Commercial"},{url:e,icon:"account_box",text:"Landlords"},{url:t,icon:"account_circle",text:"My CherryDoor"}]},profileMenuLinks:function(){var e=r.user&&"landlord"===r.user.role?"/my-cherrydoor/requests/my-enquires":"/my-cherrydoor/requests/tradesman-job-requests";return[{icon:"star_rate",url:e,text:"My requests"},{icon:"person",url:"/my-cherrydoor/details",text:"My Details"},{icon:"favorite",url:"/my-cherrydoor/saved-properties",text:"Saved Properties"},{icon:"notifications",url:"/my-cherrydoor/alerts-searches",text:"Alerts & Searches"},{icon:"mode_edit",url:"/my-cherrydoor/draw-search",text:"Draw a Search"},{icon:"home",url:"/my-cherrydoor/properties",text:"My Properties"},{icon:"remove_circle_outline",url:"/my-cherrydoor/london-tube",text:"London Tube & Railway Station"}]},requestMenuLinks:function(){var e,t=[{url:"/my-cherrydoor/requests/my-enquires",text:"MY ENQUIRERS"},{url:"/my-cherrydoor/requests/tradesman-job-requests",text:"TRADESMAN-JOB-REQUESTS"}];return r.user&&(e=r.user.role),"landlord"==e&&t.splice(1,1),t},myDetailLinks:function(){return[{url:"/my-cherrydoor/details",text:"Update contact details"},{url:"/my-cherrydoor/details/change-my-password",text:"Change my password"},{url:"/my-cherrydoor/details/change-my-email",text:"Change your email"},{url:"/my-cherrydoor/details/deactivate-my-account",text:"Deactivate Account"},{url:"/my-cherrydoor/details/verify-details",text:"Verify Details"},{url:"",text:"Messaging"}]}}}]).factory("PostcodeSvr",["$http","POSTCODE",function(e,r){return{lookup:function(t,o){var a=r.API_URL+"v1/postcodes/"+t+"?api_key="+r.API_KEY;return e.get(a,{cache:o})},address:function(t,o){var a=r.API_URL+"v1/addresses?q="+t+"&api_key="+r.API_KEY;return e.get(a,{cache:o})},autocomplete:function(t,o){var a=r.API_URL+"v1/autocomplete/addresses?q="+t+"&api_key="+r.API_KEY;return e.get(a,{cache:o})}}}]),angular.module("app.factories").factory("dialogService",["$mdDialog",function(e){return{confirm:function(r,t){var o=e.confirm().title("Confirmation Message").textContent(r.text).ariaLabel("confirmation_dialog").targetEvent(t).ok("Cancel").cancel(r.ok);return e.show(o)}}}]),angular.module("app.factories").factory("RestSvr",["$http",function(e){return{search:function(r,t,o){var a=angular.isUndefined(o)?"":"?"+o;return e.post(r+a,t).then(function(e){return e.data.errors?{errors:e.data.errors}:{records:e.data.data.records,paging:e.data.data.paging}},function(e){return{errors:e.data.errors}})},login:function(r,t){return e.post(r,t).then(function(e){return e.data.errors?{errors:e.data.errors}:{result:e.data.data.success,user:e.data.data.user,token:e.data.data.token}},function(e){return{errors:e.data.errors}})},paginate:function(r,t,o,a){var s=angular.isUndefined(t)?"":t,n=angular.isUndefined(o)?"":"?"+o;return e.get(r+s+n,a).then(function(e){return e.data.errors?{errors:e.data.errors}:{records:e.data.data.records,paging:e.data.data.paging,group:e.data.data.group}})},get:function(r,t){var o=angular.isUndefined(t)?null:t;return e.get(r,o).then(function(e){return{record:e.data.data.record}})},getById:function(r,t){return e.get(r+t).then(function(e){return{record:e.data}})},post:function(r,t){return e.post(r,t).then(function(e){return e.data.errors?{errors:e.data.errors}:{result:e.data.data.success,message:e.data.data.message,data:e.data.data.record}},function(e){return{errors:e.data.errors}})},put:function(r,t,o,a){var s=angular.isUndefined(a)?null:a;return e.put(r+t,o,s).then(function(e){return e.data.errors?{errors:e.data.errors}:{result:e.data.data.success,message:e.data.data.message,data:e.data.data.record}},function(e){return{errors:e.data.errors}})},delete:function(r,t){return e.delete(r+t).then(function(e){return e.data.errors?{errors:e.data.errors}:{message:e.data.data.message,result:e.data.data.success}},function(e){return{errors:e.data.errors}})}}}]),angular.module("app.factories").factory("StaticSvr",function(){return{getUserRoles:function(){return[{value:"tenant1",text:"I am a first time buyer"},{value:"tenant2",text:"I am a buyer (not first time)"},{value:"tenant",text:"I am looking to rent"},{value:"landlord",text:"I am a landlord"},{value:"tenant3",text:"Other"}]}}}),angular.module("app.factories").factory("toastService",["$mdToast","$timeout",function(e,r){return{alert:function(t){e.hide(),r(function(){var r=e.simple().textContent(t.message).position("top right").toastClass("fixed "+t.class).action("x").hideDelay(3e3);e.show(r).then(function(r){"ok"==r&&e.hide()})},1e3)}}}]),angular.module("app.config",["LocalStorageModule"]).config(["$httpProvider",function(e){var r=["$q","localStorageService","AuthSrv","$location","$rootScope","POSTCODE","$log",function(e,r,t,o,a,s,n){var i=r.get("staySignedIn");return{request:function(e){e.headers=e.headers||{};var o=r.get("token",i);return o&&(e.headers.Authorization="Bearer "+o,t.isLogged=1),e},requestError:function(r){return e.reject(r)},response:function(r){return r||e.when(r)},responseError:function(s){return 401===s.status&&void 0!==s.data.errors.code&&(a.$broadcast("TokenExpiredError",{message:"Session has been expired, please login again."}),r.remove("staySignedIn","localStorage"),r.remove("token",i),r.remove("user",i),delete a.user,t.isLogged=!1,o.path("/login")),e.reject(s)}}}];e.interceptors.push(r)}]).config(["$mdThemingProvider","$mdDateLocaleProvider",function(e,r){e.theme("default").primaryPalette("blue").accentPalette("blue"),e.enableBrowserColor({theme:"blue",palette:"blue",hue:"800"}),r.formatDate=function(e){return angular.isUndefined(e)?"":moment(e).format("DD/MM/YYYY")}}]).config(["localStorageServiceProvider",function(e){var r,t=window.location.port;switch(t){case"9000":r="dev";break;case"9001":r="qa";break;case"9002":r="uat";break;default:r="local"}e.setPrefix(r)}]).constant("POSTCODE",{API_KEY:"ak_ius21ypnuBLfEO95IfdZpB5WeNEJ6",API_URL:"https://api.ideal-postcodes.co.uk/"}).constant("GOOGLEMAP",{API_KEY:"AIzaSyAOv3L4ppIKkwOPBa2bohfJqjqiWkuLODk",API_URL:"https://maps.googleapis.com/maps/api/js"}).run(["$location","$rootScope","localStorageService","AuthSrv","CommanSrv","toastService","$mdSidenav","$timeout",function(e,r,t,o,a,s,n,i){r.filterSpinner=!0,r.$on("$includeContentLoaded",function(e,t){"assets/user/partials/rent_search_filters.html"===t&&(r.filterSpinner=!1)});var l=t.get("staySignedIn");r.$on("$routeChangeStart",function(s,n,i){r.blackheader=a.getHeaderColor(),r.navlinks=a.navbarLinks(),null===n||void 0===n.access||!n.access.requiredLogin||o.isLogged||t.get("user",l)||(o.isLogged=0,e.path("/login"))}),r.$on("$routeChangeSuccess",function(e,t,o){if(!angular.isUndefined(o)&&!angular.isUndefined(o.$$route)){var a=o.$$route.originalPath;r.previousPath=a}}),r.clearToken=function(){t.remove("staySignedIn","localStorage"),t.remove("token",l),t.remove("user",l),delete r.user,o.isLogged=!1,e.path("/login")},r.$on("TokenExpiredError",function(e,r){s.alert({message:r.message,class:"error"})}),r.user=t.get("user",l),r.toggleLeft=function(e){n(e).toggle()},r.closeSidenav=function(e){n(e).close()}}]),angular.module("app.routes",["ngRoute","angular-loading-bar"]).config(["$routeProvider","cfpLoadingBarProvider","$locationProvider",function(e,r,t){r.includeSpinner=!1,e.when("/",{controller:"homeCtrl",templateUrl:"assets/user/home/views/home.html",access:{requiredLogin:!1}}).when("/login",{controller:"authCtrl",templateUrl:"assets/user/auth/views/login.html",access:{requiredLogin:!1}}).when("/register",{controller:"authCtrl",templateUrl:"assets/user/auth/views/register.html",access:{requiredLogin:!1}}).when("/forgot-password",{controller:"authCtrl",templateUrl:"assets/user/auth/views/forgot_password.html",access:{requiredLogin:!1}}).when("/reset/:token",{controller:"authCtrl",templateUrl:"assets/user/auth/views/reset_password.html",access:{requiredLogin:!1}}).when("/invalid-password",{templateUrl:"assets/user/templates/invalid-password.html",access:{requiredLogin:!1}}).when("/payment-successful",{templateUrl:"assets/user/properties/views/payment-successful.html",access:{requiredLogin:!1}}).when("/transaction-failed",{templateUrl:"assets/user/properties/views/payment-failed.html",access:{requiredLogin:!1}}).when("/invalid-email-link",{templateUrl:"assets/user/templates/invalid-email-link.html",access:{requiredLogin:!1}}).when("/create-alerts-searches",{controller:"profileCtrl",templateUrl:"assets/user/profile/views/create-alerts-searches.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/details/change-my-password",{controller:"profileCtrl",templateUrl:"assets/user/profile/views/change-password.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/details/change-my-email",{controller:"profileCtrl",templateUrl:"assets/user/profile/views/change-email.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/details/deactivate-my-account",{controller:"profileCtrl",templateUrl:"assets/user/profile/views/deactivate-account.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/details/verify-details",{controller:"profileCtrl",templateUrl:"assets/user/profile/views/verify-details.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/requests/my-enquires",{controller:"landlordEnquiriesCtrl",templateUrl:"assets/user/tenant/views/tenant-enquires.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/requests/tradesman-job-requests",{controller:"proTraderCtrl",templateUrl:"assets/user/professional-trader/views/tradesman-job-requests.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/details",{controller:"profileCtrl",templateUrl:"assets/user/profile/views/my-detail.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/saved-properties",{controller:"savedPropertiesCtrl",templateUrl:"assets/user/profile/views/saved-properties.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/alerts-searches",{controller:"alertSearchesCtrl",templateUrl:"assets/user/profile/views/alerts-searches.html",access:{requiredLogin:!0}}).when("/my-cherrydoor/draw-search",{controller:"profileCtrl",templateUrl:"assets/user/profile/views/draw-search.html",access:{requiredLogin:!1}}).when("/my-cherrydoor/properties",{controller:"profileCtrl",templateUrl:"assets/user/profile/views/my-properties.html",access:{requiredLogin:!1}}).when("/my-cherrydoor/london-tube",{controller:"profileCtrl",templateUrl:"assets/user/profile/views/my-cherrydoor-london-tube.html",access:{requiredLogin:!0}}).when("/property-search-listing",{controller:"searchCtrl",templateUrl:"assets/user/search/views/property-search-listing.html",access:{requiredLogin:!1}}).when("/save-search",{controller:"saveSearchCtrl",templateUrl:"assets/user/search/views/save-search.html",access:{requiredLogin:!0}}).when("/property-search-listing-sample",{controller:"profileCtrl",templateUrl:"assets/user/templates/property-search-listing-sample.html",access:{requiredLogin:!1}}).when("/draw-search-area",{controller:"profileCtrl",templateUrl:"assets/user/templates/draw-search-area.html",access:{requiredLogin:!1}}).when("/property-room-details",{controller:"propertiesCtrl",templateUrl:"assets/user/properties/views/property-room-details.html",access:{requiredLogin:!0}}).when("/property-tenancy-details",{controller:"propertiesCtrl",templateUrl:"assets/user/properties/views/property-tenancy-details-restriction.html",access:{requiredLogin:!0}}).when("/property-sale-details",{controller:"propertiesCtrl",templateUrl:"assets/user/properties/views/property-sale-details.html",access:{requiredLogin:!0}}).when("/property-media",{controller:"propertiesCtrl",templateUrl:"assets/user/properties/views/property-media.html",access:{requiredLogin:!0}}).when("/checkout/:slug",{controller:"checkoutCtrl",templateUrl:"assets/user/properties/views/checkout.html",access:{requiredLogin:!0}}).when("/property-listings",{controller:"propertyListingCtrl",templateUrl:"assets/user/properties/views/property-listings.html",access:{requiredLogin:!0}}).when("/landload-intro",{controller:"homeCtrl",templateUrl:"assets/user/templates/landload.html",access:{requiredLogin:!1}}).when("/landload-details",{controller:"homeCtrl",templateUrl:"assets/user/templates/landload-details.html",access:{requiredLogin:!1}}).when("/landlord-property-preview/:slug",{controller:"propertyDetailCtrl",templateUrl:"assets/user/properties/views/property-detail.html",access:{requiredLogin:!1}}).when("/landlord-detail",{controller:"homeCtrl",templateUrl:"assets/user/templates/landlord-details.html",access:{requiredLogin:!1}}).when("/professional-traders-account",{controller:"homeCtrl",templateUrl:"assets/user/templates/professional-traders-account.html",access:{requiredLogin:!1}}).when("/professional-traders-job",{controller:"homeCtrl",templateUrl:"assets/user/templates/professional-traders-job.html",access:{requiredLogin:!1}}).when("/professional-traders-my-payment",{controller:"homeCtrl",templateUrl:"assets/user/templates/professional-traders-my-payment.html",access:{requiredLogin:!1}}).when("/professional-traders-my-profile",{controller:"homeCtrl",templateUrl:"assets/user/templates/professional-traders-my-profile.html",access:{requiredLogin:!1}}).when("/professional-traders-work-order",{controller:"homeCtrl",templateUrl:"assets/user/templates/professional-traders-work-order.html",access:{requiredLogin:!1}}).when("/professional-traders-my-services",{controller:"homeCtrl",templateUrl:"assets/user/templates/professional-traders-my-services.html",access:{requiredLogin:!1}}).when("/property/:slug",{controller:"propertyDetailCtrl",templateUrl:"assets/user/properties/views/property-detail.html",access:{requiredLogin:!1}}).when("/property-sale",{controller:"homeCtrl",templateUrl:"assets/user/templates/property-sale.html",access:{requiredLogin:!1}}).when("/property-rent",{controller:"homeCtrl",templateUrl:"assets/user/templates/property-rent.html",access:{requiredLogin:!1}}).when("/professional-traders",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/professional-traders.html",access:{requiredLogin:!1}}).when("/saved-property",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/saved-property.html",access:{requiredLogin:!1}}).when("/saved-search",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/saved-search.html",access:{requiredLogin:!1}}).when("/explore-neighbourhood-school",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/explore-neighbourhood-school.html",access:{requiredLogin:!1}}).when("/explore-neighbourhood-borough-council",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/explore-neighbourhood-borough-council.html",access:{requiredLogin:!1}}).when("/explore-neighbourhood-places-of-interest",{controller:"homeCtrl",templateUrl:"assets/user/templates/explore-neighbourhood-places-of-interest.html",access:{requiredLogin:!1}}).when("/professional-trades",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/search-professional-trades.html",access:{requiredLogin:!1}}).when("/become-franchise",{controller:"becomeFranchiseeCtrl",templateUrl:"assets/user/franchisee/views/become-franchise.html",access:{requiredLogin:!1}}).when("/edit-property/:slug",{controller:"editPropertiesCtrl",templateUrl:"assets/user/properties/views/edit_property.html",access:{requiredLogin:!0}}).when("/property-map-view",{controller:"propertyListingCtrl",templateUrl:"assets/user/properties/views/property-map-view.html",access:{requiredLogin:!1}}).when("/landlord-account",{controller:"landlordAccountCtrl",templateUrl:"assets/user/landlord/views/landload-account.html",access:{requiredLogin:!0}}).when("/landlord-change-password",{controller:"landlordAccountCtrl",templateUrl:"assets/user/landlord/views/landlord-change-password.html",access:{requiredLogin:!0}}).when("/landlord-banking",{controller:"landlordBankingCtrl",templateUrl:"assets/user/landlord/views/landlord-banking.html",access:{requiredLogin:!0}}).when("/landload-dashboard-plan",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-dashboard-plan.html",access:{requiredLogin:!0}}).when("/maintenance-work-orders",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/maintenance-work-orders.html",access:{requiredLogin:!1}}).when("/landload-enquiries",{controller:"landlordEnquiriesCtrl",templateUrl:"assets/user/landlord/views/landload-enquiries.html",access:{requiredLogin:!0}}).when("/landload-professional-tradesman",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-professional-tradesman.html",access:{requiredLogin:!1}}).when("/landload-property-viewing",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-property-viewing.html",access:{requiredLogin:!1}}).when("/landload-property-visits",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-property-visits.html",access:{requiredLogin:!1}}).when("/landload-safety-inspection",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-safety-inspection.html",access:{requiredLogin:!1}}).when("/landload-tenancy-details",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-tenancy-details.html",access:{requiredLogin:!1}}).when("/landload-invoices",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-invoices.html",access:{requiredLogin:!1}}).when("/landload-important-messages",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-important-messages.html",access:{requiredLogin:!1}}).when("/landload-electrical-safety",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-electrical-safety.html",access:{requiredLogin:!1}}).when("/landload-gas-safety",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-gas-safety.html",access:{requiredLogin:!1}}).when("/landload-inventory-check-in",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-inventory-check-in.html",access:{requiredLogin:!1}}).when("/landload-photography",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-photography.html",access:{requiredLogin:!1}}).when("/landload-Insurance",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-Insurance.html",access:{requiredLogin:!1}}).when("/landload-my-statements",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-my-statements.html",access:{requiredLogin:!1}}).when("/landlord-Insurance-desh",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landlord-Insurance-desh.html",access:{requiredLogin:!1}}).when("/landlord-referencing",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landlord-referencing.html",access:{requiredLogin:!1}}).when("/deposit-protection",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landlord-deposit-protection.html",access:{requiredLogin:!1}}).when("/landload-epc",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-epc.html",access:{requiredLogin:!1}}).when("/landload-assured",{controller:"professionalTraderCtrl",templateUrl:"assets/user/landlord/views/landload-assured.html",access:{requiredLogin:!1}}).when("/where-to-live",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/where-to-live.html",access:{requiredLogin:!1}}).when("/student-guide-to-renting",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/student-guide-to-renting.html",access:{requiredLogin:!1}}).when("/living-in-private-halls",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/living-in-private-halls.html",access:{requiredLogin:!1}}).when("/moving-out-of-a-property",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/moving-out-of-a-property.html",access:{requiredLogin:!1}}).when("/international-students",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/international-students.html",access:{requiredLogin:!1}}).when("/charity",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/charity.html",access:{requiredLogin:!1}}).when("/securing-a-property",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/securing-a-property.html",access:{requiredLogin:!1}}).when("/be-realistic-about-what-you-can-afford",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/be-realistic-about-what-you-can-afford.html",access:{requiredLogin:!1}}).when("/tenancy-agreements",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/tenancy-agreements.html",access:{requiredLogin:!1}}).when("/viewing-properties",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/viewing-properties.html",access:{requiredLogin:!1}}).when("/condensation-and-mould",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/condensation-and-mould.html",access:{requiredLogin:!1}}).when("/gas-safety",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/gas-safety.html",access:{requiredLogin:!1}}).when("/inventories",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/inventories.html",access:{requiredLogin:!1}}).when("/why-do-i-need",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/why-do-i-need.html",access:{requiredLogin:!1}}).when("/your-listing",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/your-listing.html",access:{requiredLogin:!1}}).when("/your-responsibilities",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/your-responsibilities.html",access:{requiredLogin:!1}}).when("/legal-musts-for-landlord",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/legal-musts-for-landlord.html",access:{requiredLogin:!1}}).when("/privacy-policy",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/privacy-policy.html",access:{requiredLogin:!1}}).when("/tenancy-details-document",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/tenancy-details-document.html",access:{requiredLogin:!1}}).when("/i-need-to-move-out-students",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/i-need-to-move-out-students.html",access:{requiredLogin:!1}}).when("/what-are-my-requirements",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/what-are-my-requirements.html",access:{requiredLogin:!1}}).when("/landlords-insurance-cover",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/landlords-insurance-cover.html",access:{requiredLogin:!1}}).when("/pricing-and-letting-fee-information",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/pricing-and-letting-fee-information.html",access:{requiredLogin:!1}}).when("/FAQ",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/FAQ.html",access:{requiredLogin:!1}}).when("/FAQ-student",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/FAQ-student.html",access:{requiredLogin:!1}}).when("/FAQ-tenants",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/FAQ-tenants.html",access:{requiredLogin:!1}}).when("/about-us",{controller:"professionalTraderCtrl",templateUrl:"assets/user/templates/about-us.html",access:{requiredLogin:!1}}).when("/offline",{controller:"",templateUrl:"offline.html",access:{requiredLogin:!1}}).otherwise({redirectTo:"/"})}]),angular.module("app.factories").factory("AuthSrv",function(){var e={isLogged:!1};return e}),angular.module("app.controllers").controller("authCtrl",["$scope","RestSvr","StaticSvr","toastService","$location","localStorageService","$rootScope","$routeParams","AuthSrv",function(e,r,t,o,a,s,n,i,l){e.roles=t.getUserRoles();var c=a.search();c&&(e.emailVerified="true"===c.emailVerified),e.register=function(t){t&&r.post("/register",e.user).then(function(r){r.errors?o.alert({message:r.errors.email.message||r.errors.message,class:"error"}):e.result=r.result})},e.login=function(t){if(t){var i=(e.staySigned,"localStorage");s.set("staySignedIn",i,"localStorage"),s.setStorageType(i),r.login("/login",e.user).then(function(e){e.errors&&o.alert({message:e.errors.message,class:"error"}),e.token&&e.user&&(s.remove("token","localStorage"),s.remove("token","sessionStorage"),s.remove("user","localStorage"),s.remove("user","sessionStorage"),s.set("token",e.token,i),s.set("user",e.user,i),l.isLogged=!0,n.user=s.get("user",i),["/property-search-listing"].indexOf(n.previousPath)!==-1?a.path(n.previousPath):a.path("/my-cherrydoor/details"),a.search(""))})}},e.result=!1,e.forgot=function(t){t&&r.post("/forgot",e.user).then(function(r){r.errors?o.alert({message:r.errors.message,class:"error"}):(e.result=r.result,e.message=r.message)})},e.reset=function(t){if(t){if(e.new_password!==e.confirm_password)return void o.alert({message:"Password don't match",class:"error"});i.token.trim();r.put("/reset/",i.token,{password:e.new_password}).then(function(e){e.errors?o.alert({message:e.errors.message,class:"error"}):(o.alert({message:e.message,class:"success"}),a.path("/login"))})}}}]),angular.module("app.directives").directive("pwCheck",[function(){return{require:"ngModel",scope:{pwCheck:"="},link:function(e,r,t,o){var a="#"+t.pwCheck;r.add(a).on("keyup",function(){e.$apply(function(){var t=r.val()===e.pwCheck;o.$setValidity("pwmatch",t)})})}}}]),angular.module("app.controllers").controller("homeCtrl",["$scope","$location","PostcodeSvr","PropertySvr","localStorageService","RestSvr","SearchHistory",function(e,r,t,o,a,s,n){function i(e){return t.autocomplete(e,!0).then(function(e){return e.data.result.hits})}e.querySearch=i,o.propertyAdditionals("property_type").then(function(r){e.property_rental=r}),e.monthly_price=o.getMonthlyPrice(),e.salePrice=o.getSalePrice(),e.items=[{title:"Discover Your Perfect Home",text:"with the most complete source of homes for sale & real estate near you",image:"images/slider-1.jpg"},{title:"This heading text for second slide",text:"This sub-text for second slide",image:"images/slider-1.jpg"}],e.properties=[{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1,,000",purpose:"For Sale",type:"Apartment",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem "},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"},{image:"images/faeturecal.png",price:"$1, 249,000",purpose:"For Sale",type:"Villa in Hialeah, Lorem Ipsum",description:"Lorem Ipsum Dummy Lorem Ipsum Dummy Lorem Ipsum Dummy"}],e.rent_search_form=function(e){e.property_for="rent",angular.isUndefined(e.availableDate)||(e.available_date=moment(e.availableDate).format("MM-DD-YYYY")),n.add("homePageSearch",e),a.remove("searchResultPage"),a.remove("isMoreRefinement"),r.path("property-search-listing").search("q",angular.toJson(e))},e.sale_search_form=function(e){e.property_for="sale",angular.isUndefined(e.availableDate)||(e.available_date=moment(e.availableDate).format("MM-DD-YYYY")),n.add("homePageSearch",e),a.remove("searchResultPage"),a.remove("isMoreRefinement"),r.path("property-search-listing").search("q",angular.toJson(e))}}]),angular.module("app.directives").directive("owlCarousel",["$timeout",function(e){return{restrict:"E",transclude:!1,link:function(e){e.initCarousel=function(r){var t={},o=e.$eval($(r).attr("data-options"));for(var a in o)t[a]=o[a];$(r).owlCarousel(t)}}}}]).directive("owlCarouselItem",["$timeout",function(e){return{restrict:"A",transclude:!1,link:function(r,t){r.$last&&e(function(){r.initCarousel(t.parent())},100)}}}]).directive("owlCarouselThumb1",["$timeout",function(e){return{restrict:"E",transclude:!1,link:function(e){e.initCarousel1=function(r){var t={},o=e.$eval($(r).attr("data-options"));for(var a in o)t[a]=o[a];$(r).owlCarousel(t).on("changed.owl.carousel",syncPosition)}}}}]).directive("owlCarouselThumb2",["$timeout",function(e){return{restrict:"E",transclude:!1,link:function(e){e.initCarousel2=function(r){
var t={},o=e.$eval($(r).attr("data-options"));for(var a in o)t[a]=o[a];$(r).owlCarousel(t).on("changed.owl.carousel",syncPosition2)}}}}]).directive("owlCarouselThumbItemFirst",["$timeout",function(e){return{restrict:"A",transclude:!1,link:function(r,t){r.$last&&e(function(){r.initCarousel1(t.parent())},100)}}}]).directive("owlCarouselThumbItemSecond",["$timeout",function(e){return{restrict:"A",transclude:!1,link:function(r,t){r.$last&&e(function(){r.initCarousel2(t.parent())},100)}}}]),angular.module("app.controllers").controller("profileCtrl",["$scope","RestSvr","dialogService","$rootScope","toastService","localStorageService","$location","PostcodeSvr","$timeout",function(e,r,t,o,a,s,n,i,l){var c=s.get("staySignedIn","localStorage"),u=s.get("user",c);o.user=u,e.updateDetails=function(t){t&&r.put("/update_account/",e.user._id,e.user).then(function(e){e.errors?angular.forEach(e.errors,function(e){a.alert({message:e.message,class:"error"})}):(s.set("user",e.data,s.get("staySignedIn","localStorage")),a.alert({message:e.message,class:"success"}))})},e.findByPostcode=function(r){r&&i.lookup(r,!0).then(function(r){e.postcodeResults=r.data.result,e.postcodeinvalid=!1},function(r){e.postcodeinvalid=!0,e.postcode_response_message=r.data.message,e.postcodeResults=[]})},e.user.address&&e.findByPostcode(e.user.address.postcode),e.changePassword=function(t){if(t)return e.cuser.new_password!==e.cuser.confirm_password?a.alert({message:"New password and confirm password are not same",class:"error"}):void r.put("/change_password/",e.user._id,e.cuser).then(function(r){r.errors?a.alert({message:r.errors.message,class:"error"}):(e.userPassChangeForm.$setPristine(),e.userPassChangeForm.$setUntouched(),l(function(){e.cuser={}},1e3),a.alert({message:r.message,class:"success"}))})},e.updateEmail=function(t){if(t)return e.changeEmail.conemail!==e.changeEmail.newemail?a.alert({message:"Email and confirm Email does not match.",class:"error"}):void r.put("/update_email/",e.user._id,e.changeEmail).then(function(r){r.errors?a.alert({message:r.errors.message,class:"error"}):(u.email=e.changeEmail.newemail,e.user.email=u.email,s.set("user",u,c),e.changeEmailForm.$setPristine(),e.changeEmailForm.$setUntouched(),l(function(){e.changeEmail={}},1e3),a.alert({message:r.message,class:"success"}))})},e.deactivateUserAccount=function(i,l){l&&t.confirm({text:"Are you sure want deactivate your cherrydoor account ?",ok:"Deactivate"},i).then(function(e){},function(t){r.put("/deactive_user/",e.user._id,e.deUser).then(function(e){e.errors&&a.alert({message:e.errors.message,class:"error"}),e.result===!0&&(a.alert({message:e.message,class:"success"}),s.remove("staySignedIn","localStorage"),s.remove("token",c),s.remove("user",c),delete o.user,n.path("/login"))})})}}]),angular.module("app.controllers").controller("savedPropertiesCtrl",["$scope","RestSvr","$rootScope","dialogService","toastService","localStorageService","$location","$timeout","PropertySvr","$mdDialog",function(e,r,t,o,a,s,n,i,l,c){l.propertyAdditionals("property_type").then(function(r){e.property_rental=r}),e.forceEllipses=!0,e.maxSize=10,e.paging={page:1},e.spinner=!0;var u=function(o,s){var n=angular.isUndefined(o)?"":"&sort="+o,i=angular.isUndefined(s)?"":"&propertyFor="+s;r.paginate("save_property/",t.user._id,"page="+e.paging.page+n+i).then(function(r){r.errors?a.alert({message:r.errors.message,class:"error"}):(e.saved_properties=r.records,e.paging=r.paging,e.group=r.group)})};u(),e.pageChanged=function(){u()},e.delete=function(n,i){var l=e.saved_properties[n];o.confirm({text:"Are you sure want to remove this property from saved list ?",ok:"Delete"},i).then(function(e){},function(e){r.put("save_property/",t.user._id,{propertyid:l.properties._id}).then(function(e){e.errors?a.alert({message:e.errors.message,class:"error"}):(e.data&&(s.set("user",e.data,s.get("staySignedIn","localStorage")),t.user=e.data),a.alert({message:e.message,class:"success"})),u()})})},e.sortByDate=function(e){u(e)},e.propertyFor=function(e){u(void 0,e)},e.showContactAgent=function(r,o){e.propertyOwner=e.saved_properties[o],e.propertyOwner.user_id=e.propertyOwner.property_owner,e.enquiryUser=t.user?angular.copy(t.user):null;var a=angular.element(document.body);c.show({parent:a,targetEvent:r,templateUrl:"assets/user/properties/views/contact-agent-dialog.html",clickOutsideToClose:!0,scope:e.$new()})},e.closeDialog=function(){c.hide()},e.contact_to_agent=function(o,s){o&&(s.property_id=e.propertyOwner.properties._id,s.channel=e.propertyOwner.properties.property_for,s.property_address=e.propertyOwner.properties.virtual_name,s.landlord_user=angular.isUndefined(e.propertyOwner.user_id.firstname)?e.propertyOwner.user_id.email:e.propertyOwner.user_id.firstname+" "+e.propertyOwner.user_id.lastname,s.landlord_email=e.propertyOwner.user_id.email,s.landlord_id=e.propertyOwner.user_id._id,delete s.status,e.onSubmit=!0,r.put("enquiry/",e.propertyOwner.user_id._id+"/"+t.user._id,s).then(function(r){e.onSubmit=!1,r.errors?a.alert({message:r.errors.message,class:"error"}):(e.closeDialog(),a.alert({message:r.message,class:"success"}))}))}}]),angular.module("app.controllers").controller("alertSearchesCtrl",["$scope","RestSvr","dialogService","$rootScope","toastService","localStorageService","$location","SearchHistory",function(e,r,t,o,a,s,n,i){function l(t){var s=void 0!==t?t:"";r.get("save_search/"+o.user._id+s).then(function(r){r.errors?a.alert({message:r.errors.message,class:"error"}):(e.searchAlerts=r.record?r.record.user:[],e.property_for_counts=r.record?r.record.counts:[])})}l(),e.delete=function(s,n){var i=e.searchAlerts[s].save_searches._id;t.confirm({text:"Are you sure want to delete this search from saved list ?",ok:"Delete"},n).then(function(e){},function(e){r.delete("save_search/",i+"/"+o.user._id).then(function(e){e.errors?a.alert({message:e.errors.message,class:"error"}):l()})})},e.search_this_address=function(r){var t=e.searchAlerts[r].save_searches.filters;n.path("property-search-listing").search("q",angular.toJson(t))},e.search_history=s.get("homePageSearch","localStorage"),e.search_history_address=function(r){var t=e.search_history[r];n.path("property-search-listing").search("q",angular.toJson(t))},e.remove_history=function(r){e.search_history.splice(r,1),s.set("homePageSearch",e.search_history,"localStorage")},e.setAlerts=function(r){var t=e.search_history[r];n.path("save-search").search("q",angular.toJson(t))},e.clear_all_search_history=function(){e.search_history=[],s.set("homePageSearch",e.search_history,"localStorage")},e.toggleAlert=function(t){var s=e.searchAlerts[t].save_searches,n={monthly:"noalert",immediately:"noalert",weekly:"noalert",daily:"noalert",noalert:"daily"};r.put("toggle_search_alert/",o.user._id,{_id:s._id,frequency:n[s.frequency]}).then(function(e){e.errors?a.alert({message:e.errors.message,class:"error"}):(l(),a.alert({message:e.message,class:"success"}))})},e.filterProperty=function(r){e.property_for_filter="for "+r,l("?property_for="+r)}}]),angular.module("app.controllers").controller("checkoutCtrl",["$scope","RestSvr","$routeParams","toastService","localStorageService","$location","PropertySvr","dialogService","$mdDialog","$document",function(e,r,t,o,a,s,n,i,l,c){e.quantity=1,e.additionalServiceList=function(){r.get("/checkout_additional_service_list/"+t.slug).then(function(r){e.items=r.record.cart,e.propertyId=r.record._id,e.price=0,e.items.map(function(r){e.price=e.price+r.price});var t=window.location.hostname,o=window.location.protocol,a=window.location.port;e.url=o+"//"+t+":"+a,e.notifyUrl=o+"//"+t+":"+a+"/successfull_payment",e.custom={email:"email@email.com",propertyId:r.record._id}})},e.price=10,e.checkout=function(){l.show({locals:{dataToPass:e.items},controllerAs:"ctrl",templateUrl:"assets/user/properties/views/checkout-popup.html",parent:angular.element(c.body),clickOutsideToClose:!0,scope:e.$new()})},e.remove=function(t,a,n,l){i.confirm({text:"Are you sure want to remove ?",ok:"Yes"},a).then(function(e){},function(t){return r.put("remove_item/",e.propertyId+"/"+n)}).then(function(r){r.errors?o.alert({message:r.errors.message,class:"error"}):(e.items.splice(t,1),e.price=e.price-l,o.alert({message:r.message,class:"success"}),0===e.total_no_items&&s.path("property_listings"))})},e.cancel=function(){l.hide()}}]),angular.module("app.controllers").controller("editPropertiesCtrl",["$scope","RestSvr","toastService","localStorageService","$location","PropertySvr","PostcodeSvr","$routeParams","dialogService","$timeout",function(e,r,t,o,a,s,n,i,l,c){function u(){r.get("property_detail/"+i.slug).then(function(r){r.errors?t.alert({message:r.errors.message,class:"error"}):(e.property=r.record,p(),e.available_date=new Date(e.property.available_date),e.viewing_date=e.property.viewing_date?new Date(e.property.viewing_date):h)}).then(function(e){d()})}function p(){e.property.paid_services.map(function(r){e.paid_services_info=e.paid_services_info.filter(function(e){return e._id!==r._id})})}function d(r){if(angular.isUndefined(e.property.address))return e.postcodeinvalid=!0,void(e.postcodeResults=[]);var o=e.property.address.postcode;n.lookup(o,!0).then(function(o){e.postcodeResults=o.data.result,e.postcodeinvalid=!1,r&&t.alert({message:"Postcode found",class:"success"})},function(r){e.postcodeinvalid=!0,e.postcode_response_message=r.data.message,e.postcodeResults=[]})}function m(){r.post("update_property",e.property).then(g)}function g(r){e.spinner=!1,r.errors?t.alert({message:r.errors.message,class:"error"}):e.isCheckout?a.path("/checkout/"+i.slug):(t.alert({message:r.data.message||r.message,class:"success"}),a.path("property-listings"))}var f;e.property={},e.property.cart=[];var h=new Date;e.available_date=h,e.viewing_date=h,e.minDate=new Date(e.available_date.getFullYear(),e.available_date.getMonth(),e.available_date.getDate()),e.getPropertyAdditionals=function(){s.propertyAdditionals("additionalFeature").then(function(r){e.featuresX=r}).then(function(r){return s.propertyAdditionals("property_type").then(function(r){e.property_rental=r})}).then(function(r){return s.propertyAdditionals("heating").then(function(r){e.heating=r})}).then(function(r){return s.propertyAdditionals("age").then(function(r){e.age=r})}).then(function(r){return s.propertyAdditionals("style").then(function(r){e.style=r})}).then(function(r){return s.propertyAdditionals("authority").then(function(r){e.authority=r})}).then(function(r){return s.propertyAdditionals("location").then(function(r){e.location=r})}).then(function(r){return s.propertyAdditionals("parking").then(function(r){e.parkingOptions=r})}).then(function(r){return s.propertyAdditionals("additionalExclusion").then(function(r){e.exclusion=r})}).then(function(r){return s.propertyAdditionals("additionalService").then(function(r){e.paid_services_info=r,u()})})},e.dropzoneConfig={options:{url:"update_property",paramName:"file",autoProcessQueue:!0,maxFilesize:2,headers:{Authorization:"Bearer "+o.get("token",o.get("staySignedIn"))},acceptedFiles:"image/jpeg,image/jpg,image/png",addRemoveLinks:!0,uploadMultiple:!0,dictRemoveFile:"x",dictCancelUpload:"x",parallelUploads:10,maxFiles:10,dictFileTooBig:"File size must be small from {{maxFilesize}} MB",dictMaxFilesExceeded:"You can only upload {{maxFiles}} files at once",init:function(){f=this}},eventHandlers:{addedfile:function(e){},sendingmultiple:function(r,t,o){o.append("property",angular.toJson(e.property))},success:function(e){f.removeFile(e)},successmultiple:function(e,r){u()}}},e.findByPostcode=function(r){e.property.address.address1=null,e.property.address.address2=null,e.property.address.county=null,e.property.address.town=null,e.property.address.latitude=null,e.property.address.longitude=null,d(r)},e.getIndex=function(r){var t=r||0;e.property.address.latitude=e.postcodeResults[t].latitude,e.property.address.longitude=e.postcodeResults[t].longitude},e.checkOut=function(r){e.isCheckout=!0,e.update(r)},e.update=function(r){return r?(e.spinner=!0,e.property.available_date=e.available_date,e.property.viewing_date=e.viewing_date,e.property.user_id=e.property.user_id._id,void m()):t.alert({message:"Please Check Above Errors!",class:"error"})},e.weekly=function(r){e.property.monthly_rent=void 0!==r?(52*r/12).toFixed(2):0},e.monthly=function(r){e.property.weekly_rent=void 0!==r?(12*r/52).toFixed(2):0},e.toggle=function(r,a){var s=a.map(function(e){return e._id}).indexOf(r._id);s===-1?(a.push(r),o.get("tutorial")||c(function(){e.CallMe()},100),t.alert({message:r.name+" added to basket",class:"success"})):(a.splice(s,1),t.alert({message:r.name+" removed from basket",class:"success"}))},e.exists=function(e,r){var t=r.map(function(e){return e._id}).indexOf(e._id);return t!==-1},e.property.floor_plan=[],e.toggleFloorPlan=function(e,r){var t=r.map(function(e){return e.name}).indexOf(e.name);t===-1?r.push(e):r.splice(t,1)},e.existsFloorPlan=function(e,r){var t=r.map(function(e){return e.name}).indexOf(e.name);return t!==-1},e.removePhoto=function(o,a,s){var n=a[o];l.confirm({text:"Are you sure want delete image ?",ok:"Delete"},s).then(function(e){},function(s){r.put("remove_property_photo/",e.property._id,{image:n}).then(function(r){r.errors?t.alert({message:r.errors.message,class:"error"}):(a.splice(o,1),e.property.cover_photo&&n.name===e.property.cover_photo.name&&delete e.property.cover_photo)})})},e.getImageObj=function(r){e.property.cover_photo=r},e.IntroOptions={steps:[{element:"#step1",intro:"This is your basket, you can click here anytime and proceed to checkout.",position:"left"}],showStepNumbers:!1,exitOnOverlayClick:!0,exitOnEsc:!0,showBullets:!1,doneLabel:"<strong>Thanks</strong>"},e.CompletedEvent=function(e){o.set("tutorial","complete","localStorage")},e.ExitEvent=function(e){o.set("tutorial","complete","localStorage")}}]),angular.module("app.directives").directive("dropzone",[function(){return{scope:{dropzone:"="},link:function(e,r,t){var o,a;o=e.dropzone,a=new Dropzone(r[0],o.options),angular.forEach(o.eventHandlers,function(e,r){a.on(r,e)})}}}]),angular.module("app.controllers").controller("propertiesCtrl",["$scope","RestSvr","toastService","localStorageService","$location","PropertySvr","PostcodeSvr",function(e,r,t,o,a,s,n){function i(){var t=Object.assign(e.step1,e.step2,e.step3,{user_id:m._id});r.post("property",t).then(c)}function l(e){o.remove("step1","localStorage"),o.remove("step2","localStorage"),o.remove("step3","localStorage"),a.path("checkout/"+e)}function c(r){if(e.spinner=!1,e.spinner1=!1,r.errors)angular.forEach(r.errors,function(e,r){t.alert({message:e.message,class:"error"})});else{t.alert({message:r.data.message||r.message,class:"success"});var s,n;angular.isUndefined(r.data.record)?(s=r.data.property_id,n=r.data.slug):(s=r.data.record.property_id,n=r.data.record.slug),e.step3.cart.length?l(n):(o.remove("step1","localStorage"),o.remove("step2","localStorage"),o.remove("step3","localStorage"),1===e.step3.submit_n_preview?a.path("landlord-property-preview/"+n):a.path("property-listings"))}}function u(r){if(angular.isUndefined(e.step1.address))return e.postcodeinvalid=!0,void(e.postcodeResults=[]);var o=e.step1.address.postcode;n.lookup(o,!0).then(function(o){e.postcodeResults=o.data.result,e.postcodeinvalid=!1,r&&t.alert({message:"Postcode found",class:"success"})},function(r){e.postcodeinvalid=!0,e.postcode_response_message=r.data.message,e.postcodeResults=[]})}var p,d,m=o.get("user",o.get("staySignedIn","localStorage"));if(e.step1={},e.step2={},e.step3={},e.spinner=!1,e.spinner1=!1,"/property-room-details"===a.path()&&s.propertyAdditionals("additionalFeature").then(function(r){e.featuresX=r}).then(function(r){return s.propertyAdditionals("property_type").then(function(r){e.property_rental=r})}).then(function(r){return s.propertyAdditionals("heating").then(function(r){e.heating=r})}).then(function(r){return s.propertyAdditionals("age").then(function(r){e.age=r})}).then(function(r){return s.propertyAdditionals("style").then(function(r){e.style=r})}).then(function(r){return s.propertyAdditionals("authority").then(function(r){e.authority=r})}).then(function(r){return s.propertyAdditionals("location").then(function(r){e.location=r})}).then(function(r){return s.propertyAdditionals("parking").then(function(r){e.parkingOptions=r})}),"/property-tenancy-details"===a.path()||"/property-sale-details"===a.path()){null===o.get("step1","localStorage")&&a.path("property-room-details");var g=new Date;e.available_date=g,e.viewing_date=g,e.minDate=new Date(e.available_date.getFullYear(),e.available_date.getMonth(),e.available_date.getDate()),s.propertyAdditionals("additionalExclusion").then(function(r){e.exclusion=r})}"/property-media"===a.path()&&(null===o.get("step1","localStorage")&&null===o.get("step2","localStorage")?a.path("property-room-details"):null===o.get("step2","localStorage")&&a.path("property-tenancy-details"),e.step3.cart=[],s.propertyAdditionals("additionalService").then(function(r){e.paid_services_info=r})),e.firstStep=function(r){return r?(o.set("step1",e.step1,"localStorage"),void("sale"===e.step1.property_for?a.path("property-sale-details"):a.path("property-tenancy-details"))):t.alert({message:"Please fill all required fields",class:"error"})},e.secondStep=function(r){if(r){if(Number(e.step2.max_price)<=Number(e.step2.min_price))return void t.alert({message:"Max Price should be greater from Min Price",class:"error"});e.step2.available_date=e.available_date,e.step2.viewing_date=e.viewing_date,e.step2.upload_by=m.role,o.set("step2",e.step2,"localStorage"),a.path("property-media")}},o.get("step1","localStorage")&&(e.step1=o.get("step1","localStorage"),angular.isUndefined(e.step1.address)||u()),o.get("step2","localStorage")&&(e.step2=o.get("step2","localStorage"),e.available_date=new Date(e.step2.available_date),e.viewing_date=new Date(e.step2.viewing_date)),e.finalStep=function(r){r&&(1===e.step3.submit_n_preview?e.spinner=!0:e.spinner1=!0,o.set("step3",e.step3,"localStorage"),e.step3=o.get("step3","localStorage"),p.getQueuedFiles().length>0?p.processQueue():i())},e.dropzoneConfig={options:{url:"property",paramName:"file",autoProcessQueue:!1,maxFilesize:2,headers:{Authorization:"Bearer "+o.get("token",o.get("staySignedIn"))},acceptedFiles:"image/*",addRemoveLinks:!0,uploadMultiple:!0,dictRemoveFile:"x",dictCancelUpload:"x",parallelUploads:10,maxFiles:10,dictFileTooBig:"File size must be small from {{maxFilesize}} MB",dictMaxFilesExceeded:"You can only upload {{maxFiles}} files at once",init:function(){p=this}},eventHandlers:{addedfile:function(e){},sendingmultiple:function(r,t,o){var a=Object.assign(e.step1,e.step2,e.step3,{user_id:m._id});o.append("property",angular.toJson(a))},successmultiple:function(e,r){c(r)}}},"function"!=typeof Object.assign&&!function(){Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),t=1;t<arguments.length;t++){var o=arguments[t];if(void 0!==o&&null!==o)for(var a in o)o.hasOwnProperty(a)&&(r[a]=o[a])}return r}}(),e.weekly=function(r){e.step2.monthly_rent=void 0!==r?(52*r/12).toFixed(2):0},e.monthly=function(r){e.step2.weekly_rent=void 0!==r?(12*r/52).toFixed(2):0},e.toggle=function(e,r){var o=r.map(function(e){return e._id}).indexOf(e._id);o===-1?(r.push(e),t.alert({message:e.name+" added to basket",class:"success"})):(r.splice(o,1),t.alert({message:e.name+" removed from basket",class:"success"}))},e.exists=function(e,r){var t=r.map(function(e){return e._id}).indexOf(e._id);return t!==-1},e.findByPostcode=function(r){e.step1.address.address1=null,e.step1.address.address2=null,e.step1.address.county=null,e.step1.address.town=null,e.step1.address.latitude=null,e.step1.address.longitude=null,u(r)},e.getIndex=function(r){d=r||0,e.step1.address.latitude=e.postcodeResults[d].latitude,e.step1.address.longitude=e.postcodeResults[d].longitude},e.goToStep2=function(){"sale"===e.step1.property_for?a.path("property-sale-details"):a.path("property-tenancy-details")},e.searchTerm,e.clearSearchTerm=function(){e.searchTerm=""},e.keyDownEvent=function(e){e.stopPropagation()}}]),angular.module("app.factories").factory("PropertySvr",["RestSvr",function(e){return{getPaidServices:function(r){return e.get("/property_additionals/"+r,{cache:!0}).then(function(e){return e.record})},propertyAdditionals:function(r){return e.get("/property_additionals/"+r,{cache:!0}).then(function(e){return e.record})},getMonthlyPrice:function(){return[100,200,300,400,500,600,700,800,900,1e3,1100,1200,1300,1400,1500,1600,1700,1800,1900,2e3,2100,2200,2300,2400,2500,2600,2700,2800,2900,3e3,3100,3200,3300,3400,3500,3600,3700,3800,3900,4e3,4100,4200,4300,4400,4500,4600,4700,4800,4900,5e3,5100,5200,5300,5400,5500,5600,5700,5800,5900,6e3,6100,6200,6300,6400,6500,6600,6700,6800,6900,7e3,7100,7200,7300,7400,7500,7600,7700,7800,7900,8e3,8100,8200,8300,8400,8500,8600,8700,8800,8900,9e3,9100,9200,9300,9400,9500,9600,9700,9800,9900,1e4,10100,10200,10300,10400,10500,10600,10700,10800,10900,11e3,11100,11200,11300,11400,11500,11600,11700,11800,11900,12e3,12100,12200,12300,12400,12500,12600,12700,12800,12900,13e3,13100,13200,13300,13400,13500,13600,13700,13800,13900,14e3,14100,14200,14300,14400,14500,14600,14700,14800,14900,15e3,15100,15200,15300,15400,15500,15600,15700,15800,15900,16e3,16100,16200,16300,16400,16500,16600,16700,16800,16900,17e3,17100,17200,17300,17400,17500,17600,17700,17800,17900,18e3,18100,18200,18300,18400,18500,18600,18700,18800,18900,19e3,19100,19200,19300,19400,19500,19600,19700,19800,19900,2e4]},getSalePrice:function(){return[1e4,6e4,11e4,16e4,21e4,26e4,31e4,36e4,41e4,46e4,51e4,56e4,61e4,66e4,71e4,76e4,81e4,86e4,91e4,96e4,101e4,106e4,111e4,116e4,121e4,126e4,131e4,136e4,141e4,146e4,151e4,156e4,161e4,166e4,171e4,176e4,181e4,186e4,191e4,196e4,201e4,206e4,211e4,216e4,221e4,226e4,231e4,236e4,241e4,246e4,251e4,256e4,261e4,266e4,271e4,276e4,281e4,286e4,291e4,296e4,301e4,306e4,311e4,316e4,321e4,326e4,331e4,336e4,341e4,346e4,351e4,356e4,361e4,366e4,371e4,376e4,381e4,386e4,391e4,396e4,401e4,406e4,411e4,416e4,421e4,426e4,431e4,436e4,441e4,446e4,451e4,456e4,461e4,466e4,471e4,476e4,481e4,486e4,491e4,496e4,501e4,506e4,511e4,516e4,521e4,526e4,531e4,536e4,541e4,546e4,551e4,556e4,561e4,566e4,571e4,576e4,581e4,586e4,591e4,596e4,601e4,606e4,611e4,616e4,621e4,626e4,631e4,636e4,641e4,646e4,651e4,656e4,661e4,666e4,671e4,676e4,681e4,686e4,691e4,696e4,701e4,706e4,711e4,716e4,721e4,726e4,731e4,736e4,741e4,746e4,751e4,756e4,761e4,766e4,771e4,776e4,781e4,786e4,791e4,796e4,801e4,806e4,811e4,816e4,821e4,826e4,831e4,836e4,841e4,846e4,851e4,856e4,861e4,866e4,871e4,876e4,881e4,886e4,891e4,896e4,901e4,906e4,911e4,916e4,921e4,926e4,931e4,936e4,941e4,946e4,951e4,956e4,961e4,966e4,971e4,976e4,981e4,986e4,991e4,996e4,1001e4,1006e4,1011e4,1016e4,1021e4,1026e4,1031e4,1036e4,1041e4,1046e4,1051e4,1056e4,1061e4,1066e4,1071e4,1076e4,1081e4,1086e4,1091e4,1096e4,1101e4,1106e4,1111e4,1116e4,1121e4,1126e4,1131e4,1136e4,1141e4,1146e4,1151e4,1156e4,1161e4,1166e4,1171e4,1176e4,1181e4,1186e4,1191e4,1196e4,1201e4]}}}]),angular.module("app.controllers").controller("propertyDetailCtrl",["$scope","RestSvr","$routeParams","toastService","localStorageService","$location","PropertySvr","GOOGLEMAP","$rootScope","fancyboxService",function(e,r,t,o,a,s,n,i,l,c){r.get("property_detail/"+t.slug).then(function(r){r.errors?o.alert({message:r.errors.message,class:"error"}):(e.property=r.record,e.fullAddress=[e.property.address.latitude,e.property.address.longitude])}),n.propertyAdditionals("additionalExclusion").then(function(r){e.property_additional_exclusion=r}),e.googleMapsUrl=i.API_URL+"?key="+i.API_KEY,e.synckBoth=function(e){angular.element("#sync1").data("owl.carousel").to(e,300,!0)},e.path=s.path(),e.enquiryUser=l.user?angular.copy(l.user):null,e.saveProperty=function(t){if(l.user){var n=l.user,i=e.property;r.put("save_property/",n._id,{propertyid:i._id}).then(function(e){e.errors?o.alert({message:e.errors.message,class:"error"}):(a.set("user",e.data,a.get("staySignedIn","localStorage")),l.user=e.data,o.alert({message:e.message,class:"success"}))})}else s.path("/login")},e.contact_to_agent=function(t,a){t&&(a.property_id=e.property._id,a.channel=e.property.property_for,a.property_address=e.property.virtual_name,a.landlord_user=angular.isUndefined(e.property.user_id.firstname)?e.property.user_id.email:e.property.user_id.firstname+" "+e.property.user_id.lastname,a.landlord_email=e.property.user_id.email,a.landlord_id=e.property.user_id._id,delete a.status,e.onSubmit=!0,r.put("enquiry/",e.property.user_id._id+"/"+l.user._id,a).then(function(r){e.onSubmit=!1,r.errors?o.alert({message:r.errors.message,class:"error"}):o.alert({message:r.message,class:"success"})}))},e.showFloorPlan=function(r,t){var o=window.location.hostname,a=window.location.protocol,s=window.location.port,n=a+"//"+o+":"+s+"/";e.floorPlan=r.map(function(e){return n+e.path+e.name}),e.manual2={padding:0,transitionIn:"none",transitionOut:"none",type:"image",changeFade:0},c.fancyboxPlus()(e.floorPlan,e.manual2)}}]),angular.module("app.controllers").controller("propertyListingCtrl",["fancyboxService","$mdDialog","$scope","RestSvr","$rootScope","toastService","localStorageService","$location","PropertySvr","dialogService","$timeout","NgMap","$document","GOOGLEMAP",function(e,r,t,o,a,s,n,i,l,c,u,p,d,m){var g=n.get("user");l.propertyAdditionals("additionalExclusion").then(function(e){t.property_additional_exclusion=e}),t.forceEllipses=!0,t.maxSize=10,t.paging={page:1},t.spinner=!0;var f=function(e,r){var a=angular.isUndefined(r)?"":"&sort="+r;o.paginate("paginate_property/",g._id,"page="+t.paging.page+a,{cache:e}).then(function(e){t.spinner=!1,e.errors?s.alert({message:e.errors.message,class:"error"}):(t.properties=e.records,t.paging=e.paging)})};f(!1),t.pageChanged=function(){f(!1)},t.mapConfig={lat:"53.0924591",lng:"-3.1649191",zooms:6},t.googleMapsUrl=m.API_URL+"?key="+m.API_KEY,p.getMap().then(function(e){t.map=e,t.isMapLoaded=!0}),t.mapCenter=function(){var e=new google.maps.LatLng(t.mapConfig.lat,t.mapConfig.lng);t.map.setCenter(e),t.map.setZoom(t.mapConfig.zooms)},t.openMapWindow=function(e,r){u(function(){t.isLoaded=!1},0),t.mapInfo=r,t.map.showInfoWindow("infoWindow",r._id)},d.on("click",function(e){}),t.publish=function(e,r){var a=t.properties[r],n=e;o.put("property/",a._id,{isPublished:e},{cache:!0}).then(function(e){if(e.errors)s.alert({message:e.errors.message,class:"error"});else{var r={true:"published",false:"Un-Published"};s.alert({message:"Property has been "+r[n]+" successfully",class:"success"})}})},t.delete=function(e,r){var a=t.properties[e];c.confirm({text:"Are you sure want delete this property ?",ok:"Delete"},r).then(function(e){},function(e){o.delete("property/",a._id).then(function(e){e.errors?s.alert({message:e.errors.message,class:"error"}):s.alert({message:e.message,class:"success"}),f(!1)})})},t.sortByPrice=function(e){f(!1,e)},t.editProperty=function(e){i.path("edit-property/"+t.properties[e].slug)},t.showFloorPlan=function(r,o){var a=window.location.hostname,s=window.location.protocol,n=window.location.port,i=s+"//"+a+":"+n+"/";t.floorPlan=r.map(function(e){return i+e.path+e.name}),t.manual2={padding:0,transitionIn:"none",transitionOut:"none",type:"image",changeFade:0},e.fancyboxPlus()(t.floorPlan,t.manual2)},t.closeDialog=function(){r.hide()}}]),angular.module("app.controllers").controller("propertyMapViewCtrl",["$scope","RestSvr","$rootScope","toastService","localStorageService","$location","PropertySvr","dialogService","$timeout","NgMap",function(e,r,t,o,a,s,n,i,l,c){}]),angular.module("app.controllers").controller("propertyPreviewCtrl",["$scope","RestSvr","$routeParams","toastService","localStorageService","$location","PropertySvr","$filter","GOOGLEMAP",function(e,r,t,o,a,s,n,i,l){r.get("property_detail/"+t.slug,{cache:!0}).then(function(r){r.errors?o.alert({message:r.errors.message,class:"error"}):(e.property=r.record,e.fullAddress=[e.property.address.latitude,e.property.address.longitude])}),e.property_additional_exclusion=n.getPropertyExclusion(),e.property_rental_type=n.getPropertyRentalType(),e.googleMapsUrl=l.API_URL+"?key="+l.API_KEY}]),angular.module("app.filters").filter("indexOf",function(){return function(e,r){if(!angular.isArray(e))return-1;var t=e.map(function(e){return e.property_id}).indexOf(r);return t}}),angular.module("app.controllers").controller("saveSearchCtrl",["$scope","$location","localStorageService","RestSvr","toastService","$rootScope","PropertySvr","$filter",function(e,r,t,o,a,s,n,i){var l=r.search(),c=l?angular.fromJson(l.q):[];if(!c)return r.path("/"),void a.alert({message:"No search to save",class:"error"});var u,p=[];c.min_beds&&c.max_beds&&"any"!==c.min_beds&&"any"!==c.max_beds?p=["with ","0"===c.min_beds?"Studio":c.min_beds," to ","0"===c.max_beds?"Studio":c.max_beds," bedrooms"]:c.min_beds&&"any"!==c.min_beds?p=["with ","0"===c.min_beds?"Studio":c.min_beds+"+"," bedrooms"]:c.max_beds&&"any"!==c.max_beds&&(p=["with ","0"===c.max_beds?"Studio":c.max_beds+"+"," bedrooms"]),u=p.length>0?p.join(""):void 0;var d,m=[];c.min_sale_price&&c.max_sale_price&&"any"!==c.min_sale_price&&"any"!==c.max_sale_price?m=["between ",i("currency")(c.min_sale_price,"£",0)," and ",i("currency")(c.max_sale_price,"£",0)]:c.min_sale_price&&"any"!==c.min_sale_price?m=["greater than ",i("currency")(c.min_sale_price,"£",0)]:c.max_sale_price&&"any"!==c.max_sale_price&&(m=["less than ",i("currency")(c.max_sale_price,"£",0)]),c.min_price_per_month&&c.max_price_per_month&&"any"!==c.min_price_per_month&&"any"!==c.max_price_per_month?m=["between ",i("currency")(c.min_price_per_month,"£",0),i("currency")(c.max_price_per_month,"£",0)]:c.min_price_per_month&&"any"!==c.min_price_per_month?m=["greater than ",i("currency")(c.min_price_per_month,"£",0)]:c.max_price_per_month&&"any"!==c.max_price_per_month&&(m=["less than ",i("currency")(c.max_price_per_month,"£",0)]),d=m.length>0?m.join(""):void 0,e.pretty_search_address=[c.property_type?c.property_type.name+" for ":"Property for ",c.property_for," in ",c.search_address||"UK ",u,d].join(""),e.createAlert=function(t){if(t){var n=Object.assign(e.alert,{prettyAddress:e.pretty_search_address,filters:c,channel:c.property_for});o.put("save_search/",s.user._id,n).then(function(e){e.errors?a.alert({message:e.errors.message,class:"error"}):(r.path("/my-cherrydoor/alerts-searches"),a.alert({message:e.message,class:"success"}))})}},e.goBack=function(){r.path("property-search-listing").search("q",angular.toJson(c))}}]),angular.module("app.factories").factory("SearchHistory",["localStorageService",function(e){const r=5,t="localStorage";var o=this;return{set:function(e){o.key=e,o.search_history=this.get(e)||[]},get:function(r){return e.get(r,t)},add:function(a,s){this.set(a);var n=angular.copy(s);o.search_history.length>r?o.search_history.pop():this.isUnique(n)||o.search_history.unshift(n),e.set(o.key,o.search_history,t)},remove:function(r){o.search_history.splice(r,1),e.set(o.key,o.search_history,t)},isUnique:function(e){return o.search_history.some(function(r){return angular.equals(r,e)})}}}]),angular.module("app.controllers").controller("searchCtrl",["fancyboxService","$scope","$location","PostcodeSvr","PropertySvr","localStorageService","RestSvr","toastService","$timeout","$rootScope","SearchHistory","$mdDialog",function(e,r,t,o,a,s,n,i,l,c,u,p){function d(){o.address(r.property.search_address,!0).then(function(e){e.data.result.hits.length>0?(r.coordinates=[e.data.result.hits[0].longitude,e.data.result.hits[0].latitude],r.property.coordinates=r.coordinates):(i.alert({message:"You need to enter valid post code or address for mile search",class:"error"}),r.property.radius="any")})}!function(){a.propertyAdditionals("property_type").then(function(e){r.property_rental=e}).then(function(){a.propertyAdditionals("additionalFeature").then(function(e){r.additionalFeatureList=e})})}();var m=t.search(),g=s.get("homePageSearch","localStorage");r.property=angular.equals(m,{})?g[0]:angular.fromJson(m.q);var f=s.get("searchResultPage","localStorage");
r.monthly_price=a.getMonthlyPrice(),r.salePrice=a.getSalePrice(),r.forceEllipses=!0,r.maxSize=10,r.paging={page:f||1},r.spinner=!0,r.querySearch=function(e){return o.autocomplete(e,!0).then(function(e){return e.data.result.hits})};var h=function(e){var t=angular.isUndefined(e)?"":"&sort="+e;n.search("search",r.property,"page="+r.paging.page+t).then(function(e){r.spinner=!1,e.errors?i.alert({message:e.errors.message,class:"error"}):(r.properties=e.records,r.paging=e.paging)})};h(),r.pageChanged=function(){h(),s.set("searchResultPage",r.paging.page,"localStorage")},r.advance_search=function(){h();var e=r.property;u.add("homePageSearch",e),t.search("q",angular.toJson(e))},r.sortByPrice=function(e){h(e)},r.saveProperty=function(e){if(c.user){var o=c.user,a=r.properties[e];n.put("save_property/",o._id,{propertyid:a._id}).then(function(e){e.errors?i.alert({message:e.errors.message,class:"error"}):(e.data&&(s.set("user",e.data,s.get("staySignedIn","localStorage")),c.user=e.data),i.alert({message:e.message,class:"success"}))})}else t.path("/login")},r.save_search=function(){t.path("save-search").search("q",angular.toJson(r.property))},r.showContactAgent=function(e,o){if(c.user){r.propertyOwner=r.properties[o],r.enquiryUser=c.user?angular.copy(c.user):null;var a=angular.element(document.body);p.show({parent:a,targetEvent:e,templateUrl:"assets/user/properties/views/contact-agent-dialog.html",clickOutsideToClose:!0,scope:r.$new()})}else t.path("/login")},r.closeDialog=function(){p.hide()},r.contact_to_agent=function(e,t){e&&(t.property_id=r.propertyOwner._id,t.channel=r.propertyOwner.property_for,t.property_address=r.propertyOwner.virtual_name,t.landlord_user=angular.isUndefined(r.propertyOwner.user_id.firstname)?r.propertyOwner.user_id.email:r.propertyOwner.user_id.firstname+" "+r.propertyOwner.user_id.lastname,t.landlord_email=r.propertyOwner.user_id.email,t.landlord_id=r.propertyOwner.user_id._id,delete t.status,r.onSubmit=!0,n.put("enquiry/",r.propertyOwner.user_id._id+"/"+c.user._id,t).then(function(e){r.onSubmit=!1,e.errors?i.alert({message:e.errors.message,class:"error"}):(r.closeDialog(),i.alert({message:e.message,class:"success"}))}))},r.showFloorPlan=function(t,o){var a=window.location.hostname,s=window.location.protocol,n=window.location.port,i=s+"//"+a+":"+n+"/";r.floorPlan=t.map(function(e){return i+e.path+e.name}),r.manual2={padding:0,transitionIn:"none",transitionOut:"none",type:"image",changeFade:0},e.fancyboxPlus()(r.floorPlan,r.manual2)},r.searchTerm,r.clearSearchTerm=function(){r.searchTerm=""},r.keyDownEvent=function(e){e.stopPropagation()},r.isValidPostcode=function(){o.lookup(r.property.search_address,!0).then(function(e){r.coordinates=[parseFloat(e.data.result[0].longitude),parseFloat(e.data.result[0].latitude)],r.property.coordinates=r.coordinates},function(e){d()})},r.more_refine=s.get("isMoreRefinement","localStorage")||!1,r.isMoreRefineOpen=function(){var e={true:!1,false:!0};r.more_refine=e[r.more_refine],s.set("isMoreRefinement",r.more_refine,"localStorage")}}]),angular.module("app.controllers").controller("proTraderCtrl",["$scope","RestSvr","$rootScope","toastService","localStorageService",function(e,r,t,o,a){}]),angular.module("app.filters").filter("unique",function(){return function(e,r){var t=[],o=[];return angular.forEach(e,function(e){var a=e[r];o.indexOf(a)===-1&&(o.push(a),t.push(e))}),t}}),angular.module("app.controllers").controller("professionalTraderCtrl",["$scope","$location","$rootScope","$mdDialog","$document",function(e,r,t,o,a){function s(e,r){e.cancel=function(){r.hide()}}e.faqToggle=!1,e.showAdvanced=function(){o.show({controller:s,templateUrl:"assets/user/templates/profesional-trader-pop.html",parent:angular.element(a.body),clickOutsideToClose:!0})},e.showcontact=function(){o.show({controller:s,templateUrl:"assets/user/templates/my-cherrydoor-my-details-deactive-account-pop.html",parent:angular.element(a.body),clickOutsideToClose:!0})},s.$inject=["$scope","$mdDialog"],e.oneAtATime=!0,e.status={isCustomHeaderOpen:!1,isFirstOpen:!0,isFirstDisabled:!1},e.faqData=[{title:"What is ……. all about?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"How does it work?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"What charges are there for Landlords?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"What is ……. all about?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"What charges are there for Tenants?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"What charges are there for Landlords?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"What is Rent Now?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"Why do tenants have to place a holding deposit?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"Who keeps the holding deposit?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"Why do you offer to process deposits?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:" What is the DPS?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"Can I see a copy of the OpenRent tenancy agreement / contract?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"How can I trust a digital signature?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"Are you a member of any letting agent associations?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"What happens to my tenancy / contract if you stop trading?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"I am a rogue landlord thinking of using your site to scam tenants!",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:"I am a letting agent - can you find me tenants too?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:" How do I pay you?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"},{title:" Why did not I have to set a password?",description:"Your first listing is free and includes listing on portals including Rightmove, Zoopla and Gumtree, and access to all our Rent Now features for only £49.Our usual price is an upfront fee of £29 per property - but you can always earn more free listings by introducing friends to OpenRent!"}]}]),angular.module("app.controllers").controller("becomeFranchiseeCtrl",["$location","toastService","RestSvr","$scope","$mdConstant",function(e,r,t,o,a){o.becomeFranchisee=function(){t.post("become_franchisee_request",o.request).then(function(t){t.errors?r.alert({message:t.errors.message,class:"error"}):(e.path("/"),r.alert({message:t.message,class:"success"}))})}}]),angular.module("app.controllers").controller("landlordAccountCtrl",["$scope","$location","PostcodeSvr","localStorageService","RestSvr","$rootScope","toastService","$timeout",function(e,r,t,o,a,s,n,i){e.landlord={};var l=o.get("staySignedIn","localStorage"),c=o.get("user",l);e.landlordDetails=function(r){r&&(e.landlord.personalDetail.correspondence_as_home&&(e.landlord.personalDetail.correspondence_address=angular.copy(e.landlord.personalDetail.address)),a.put("/update_account/",e.user._id,e.landlord.personalDetail).then(function(e){e.errors?n.alert({message:e.errors.message,class:"error"}):(o.set("user",e.data,l),n.alert({message:e.message,class:"success"}))}))},e.findByPostcode=function(r,o){r&&(o&&(e.landlord.personalDetail.address.address1=null,e.landlord.personalDetail.address.address2=null,e.landlord.personalDetail.address.county=null,e.landlord.personalDetail.address.town=null,e.landlord.personalDetail.address.country=null),t.lookup(r,!0).then(function(r){e.postcodeResults=r.data.result,e.postcodeinvalid=!1},function(r){e.postcodeinvalid=!0,e.postcode_response_message=r.data.message,e.postcodeResults=[]}))},e.findByCorrespondencePostcode=function(r,o){r&&(o&&(e.landlord.personalDetail.correspondence_address.address1=null,e.landlord.personalDetail.correspondence_address.address2=null,e.landlord.personalDetail.correspondence_address.county=null,e.landlord.personalDetail.correspondence_address.town=null,e.landlord.personalDetail.correspondence_address.country=null),t.lookup(r,!0).then(function(r){e.cpostcodeResults=r.data.result,e.cpostcodeinvalid=!1},function(r){e.cpostcodeinvalid=!0,e.cpostcode_response_message=r.data.message,e.cpostcodeResults=[]}))},c&&(e.landlord.personalDetail=c,s.user=c,e.landlord.personalDetail.address&&e.findByPostcode(e.landlord.personalDetail.address.postcode,!1),e.landlord.personalDetail.correspondence_address&&e.findByCorrespondencePostcode(e.landlord.personalDetail.correspondence_address.postcode,!1)),e.changePassword=function(r){if(r)return e.landlord.changePassword.new_password!==e.landlord.changePassword.confirm_password?n.alert({message:"New password and confirm password are not same",class:"error"}):void a.put("/change_password/",e.user._id,e.landlord.changePassword).then(function(r){r.errors?n.alert({message:r.errors.message,class:"error"}):(e.landlordChangePasswordForm.$setPristine(),e.landlordChangePasswordForm.$setUntouched(),i(function(){e.landlord.changePassword={}},1e3),n.alert({message:r.message,class:"success"}))})}}]),angular.module("app.controllers").controller("landlordBankingCtrl",["$scope","$location","localStorageService","RestSvr","$rootScope","toastService","dialogService","$timeout",function(e,r,t,o,a,s,n,i){function l(){o.get("profile/"+a.user._id).then(function(r){r.record.bank&&(e.bankDetails=r.record.bank)})}e.landlordBankDetails=function(r){r&&o.put("bank_detail/",a.user._id,e.landlord).then(function(r){r.errors?s.alert({message:r.errors.message,class:"error"}):(l(),e.landlordBankForm.$setPristine(),e.landlordBankForm.$setUntouched(),i(function(){e.landlord.bank={}},1e3),s.alert({message:r.message,class:"success"}))})},l(),e.delete=function(r,t){n.confirm({text:"Are you sure want to delete this detail ?",ok:"Delete"},t).then(function(e){},function(t){var n=e.bankDetails[r]._id;o.delete("bank_detail/",a.user._id+"/"+n).then(function(e){e.errors?s.alert({message:e.errors.message,class:"error"}):(l(),s.alert({message:e.message,class:"success"}))})})},e.edit=function(r){var t=e.bankDetails[r];e.landlord={bank:t}},e.makePrimary=function(e){e.primary=!0,o.put("make_primary_bank/",a.user._id,{bank:e}).then(function(e){e.errors?s.alert({message:e.errors.message,class:"error"}):(l(),s.alert({message:e.message,class:"success"}))})}}]),angular.module("app.controllers").controller("landlordEnquiriesCtrl",["$scope","$location","localStorageService","RestSvr","$rootScope","toastService","dialogService","$timeout","$mdDialog",function(e,r,t,o,a,s,n,i,l){function c(r,t){var n=angular.isUndefined(r)?"":"&sort="+r;o.paginate("enquiry/",a.user._id,"page="+e.paging.page+n).then(function(r){r.errors?s.alert({message:r.errors.message,class:"error"}):(e.paging=r.paging,e.enquiries=r.records)})}function u(e,r){o.put("enquiry_status/",e,r).then(function(e){e.errors?s.alert({message:e.errors.message,class:"error"}):(c(),s.alert({message:e.message,class:"success"}))})}e.forceEllipses=!0,e.maxSize=10,e.paging={page:1},e.spinner=!0,c(),e.pageChanged=function(){c()},e.notify=function(r,t,o){var a=e.enquiries[t];n.confirm({text:"Are you sure want to "+r+" this enquiry ?",ok:r},o).then(function(e){},function(e){u(a._id,{type:"toggleStatus",property_id:a.tenant_enquiries.property_id,status:r,tenant_email:a.tenant_enquiries.email})})},e.organize=function(r,t){var o=e.enquiries[r];n.confirm({text:"Are you sure want to organize refercing for this enquiry ?",ok:"Yes"},t).then(function(e){},function(e){u(o._id,{type:"referencing",property_id:o.tenant_enquiries.property_id,referencing:"scheduled",tenant_email:o.tenant_enquiries.email})})},e.makeReferencing=function(r,t){e.paymentEnquiry=e.enquiries[r],l.show({contentElement:"#paymentConfirmationDialog",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0})},e.close=function(){l.hide()},e.pay=function(){var r=e.paymentEnquiry;l.hide(),u(r.tenant_enquiries.landlord_id,{type:"referencing",property_id:r.tenant_enquiries.property_id,referencing:"done",tenant_email:r.tenant_enquiries.email})},e.filterByPropertySale=function(e){}}]),angular.module("app.controllers").controller("headerMenuCtrl",["$rootScope","$scope","$location","CommanSrv",function(e,r,t,o){function a(){r.headerPath=t.path(),r.navbarLinks=o.navbarLinks(),r.lastElement=r.navbarLinks[r.navbarLinks.length-1].url}function s(e){"my-cherrydoor"===t.path().split("/")[1]&&(r.headerPath=e)}r.$on("$routeChangeSuccess",function(e,o,n){a(),r.headerPath=t.path(),s(r.lastElement)}),a()}]),angular.module("app.directives").directive("headerMenu",["$location","CommanSrv","$rootScope",function(e,r,t){return{restrict:"A",templateUrl:"assets/user/partials/directives/templates/main-header-menu.html",link:function(e){e.$watch("user",function(){e.headerMenu=r.navbarLinks()})}}}]),angular.module("app.directives").directive("myDetail",["$location","CommanSrv",function(e,r){return{restrict:"A",scope:{userAccountMenu:"="},templateUrl:"assets/user/profile/directives/templates/my-detail-menu.html",link:function(t){var o=r.myDetailLinks();t.menu=o,t.path=e.path()}}}]),angular.module("app.directives").directive("landlordSidebar",["$location",function(e){return{restrict:"A",scope:{userAccountMenu:"="},templateUrl:"assets/user/landlord/directives/templates/landlord-sidebar.html",link:function(r){r.path=e.path(),r.oneAtATime=!0,r.status={isCustomHeaderOpen:!1,isFirstOpen:!0,isFirstDisabled:!1}},controller:["$scope","$mdDialog","RestSvr","$rootScope","localStorageService","Upload","$timeout","toastService",function(e,r,t,o,a,s,n,i){function l(t){e.spinner=!1,a.set("user",t.data.record,u),angular.isUndefined(t.data.record.profile_image)||(o.user.profile_image=t.data.record.profile_image),i.alert({message:"Profile Image Updated Successfully",class:"success"}),r.hide()}function c(r){e.spinner=!1,i.alert({message:r.message,class:"error"})}var u=a.get("staySignedIn","localStorage"),p=a.get("user",u);p&&(o.user=p);var d=this;e.myImage="",e.myCroppedImage="";var m=["image/jpeg","image/jpg","image/png"];e.selectFile=function(r,t){if(r&&m.indexOf(r.type)===-1)return void i.alert({message:"You can only upload image having file extension jpg, jpeg or png",class:"error"});d.filename=r?r.name:"";var o=new FileReader;o.onload=function(r){e.$apply(function(e){e.myImage=r.target.result,t&&e.showPrerenderedDialog()})},o.readAsDataURL(r)},e.closeImageDialog=function(){e.myImage="",r.hide()},e.showPrerenderedDialog=function(){r.show({contentElement:"#imageDialog",parent:angular.element(document.body),clickOutsideToClose:!0})},e.spinner=!1,e.uploadProfileImage=function(r,t){e.spinner=!0;var i={dataUrl:r,image_name:d.filename};s.upload({url:"/update_account/"+o.user._id,method:"PUT",headers:{Authorization:"Bearer "+a.get("token",u)},data:{profile_image:s.dataUrltoBlob(i.dataUrl,i.image_name)}}).then(function(e){n(function(){l(e.data)})},function(e){e.status>0&&c(e.data)},function(r){e.determinateValue=parseInt(100*r.loaded/r.total,10)})}}]}}]),angular.module("app.directives").directive("requestMenu",["$location","$rootScope","CommanSrv",function(e,r,t){return{restrict:"A",scope:{userRequestMenu:"="},templateUrl:"assets/user/tenant/directives/templates/request-menu-link.html",link:function(r){var o=t.requestMenuLinks();r.userRequest=o,r.currentRequestPath=e.path()}}}]),angular.module("app.directives").directive("setUrl",["$location",function(e){return{restrict:"A",transclude:!1,link:function(r,t,o){var a=o.setUrl;e.$$html5?t.attr("href","#"+a):t.attr("href","#"+a)}}}]).directive("userMenu",[function(){return{restrict:"A",scope:{userMenu:"=",clearToken:"&"},templateUrl:"assets/user/directives/templates/user-menu.html",link:function(e){var r=[{icon:"star_rate",text:"Saved Properties"},{icon:"home",url:"/property-room-details",text:"My Property"},{icon:"notifications",text:"Saved Searches & Alerts"},{icon:"person",text:"My Profile"},{icon:"settings",text:"Account Settings"}];e.list=r}}}]).directive("profileMenu",["$location","$rootScope","CommanSrv",function(e,r,t){return{restrict:"A",scope:{userProfileMenu:"="},templateUrl:"assets/user/directives/templates/profile-menu-link.html",link:function(r){var o=t.profileMenuLinks(),a=e.path().split("/");r.list=o,r.profileMenu=e.path(),"my-cherrydoor"===a[1]&&"details"===a[2]&&(r.profileMenu="/my-cherrydoor/details"),"my-cherrydoor"===a[1]&&"requests"===a[2]&&(r.profileMenu=o[0].url)}}}]).directive("passwordVerify",["$location",function(e){return{require:"ngModel",scope:{passwordVerify:"="},link:function(e,r,t,o){e.$watch(function(){var r;return(e.passwordVerify||o.$viewValue)&&(r=e.passwordVerify+"_"+o.$viewValue),r},function(r){r&&o.$parsers.unshift(function(r){var t=e.passwordVerify;return t!==r?void o.$setValidity("passwordVerify",!1):(o.$setValidity("passwordVerify",!0),r)})})}}}]);