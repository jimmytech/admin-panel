"use strict";var app=angular.module("myApp",["ngRoute","ngMaterial","ngMessages","ui.bootstrap","angular-toasty","ngImgCrop","ngFileUpload","ngCookies","ngMap","ngScrollbars"]);app.run(["$window",function(e){var t=0,n="";angular.element(e).bind("scroll",function(){var e=window.pageYOffset;n=e>=t?"down":"up",t=e,"down"==n?angular.element(document.querySelector(".hdrfixed")).addClass("down").removeClass("up"):angular.element(document.querySelector(".hdrfixed")).addClass("up").removeClass("down")})}]),app.run(["$rootScope","$location",function(e,t){e.$on("$routeChangeSuccess",function(){var n=t.path();e.headerAndSidebar="/"==n}),e.$on("$routeChangeError",function(e,n,o,r){r.authentication===!0?t.path("/my-profile"):t.path("/")}),e.$on("$routeChangeStart",function(){var n=["/how-it-works","/about-us","/search-listing","/search-listing-detail","/help-and-faq","/privacy-policy","/terms-of-use","/detail-exotic-dancing","/sign-up","/login"];"/"==t.path()||n.indexOf(t.path())>=0?e.homePage=!0:e.homePage=!1})}]).config(["$mdDateLocaleProvider",function(e){e.formatDate=function(e){return moment(e).format("DD-MM-YYYY")}}]).config(["toastyConfigProvider",function(e){e.setConfig({shake:!1,position:"top-center"})}]).config(["$httpProvider",function(e){e.interceptors.push(["$q",function(e){return{request:function(t){t.headers=t.headers||{};var n=localStorage.getItem("userToken");return n&&(t.headers.Authorization="Bearer "+n),t||e.when(t)},response:function(t){return t||e.when(t)}}}])}]),app.config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"frontend/landing/views/landing.html",controller:"landingCtrl",resolve:{validate:notRequired}}).when("/my-profile",{templateUrl:"frontend/profile/views/my_profile.html",controller:"profileCtrl",resolve:{validate:required}}).when("/sign-up",{templateUrl:"frontend/login_signup/views/signup.html",controller:"loginSignUpCtrl"}).when("/login",{templateUrl:"frontend/login_signup/views/login.html",controller:"loginSignUpCtrl"}).when("/settings",{templateUrl:"frontend/settings/views/settings.html",controller:"settingsCtrl",resolve:{validate:required}}).when("/refer-to-friend",{templateUrl:"frontend/refer/views/refer.html",controller:"referCtrl",resolve:{validate:required}}).when("/add-services",{templateUrl:"frontend/services/views/add_service.html",controller:"serviceCtrl"}).when("/add-services/service-info/complete",{templateUrl:"frontend/services/views/submit_service_1.html",controller:"submitServiceCtrl"}).when("/add-service/service-info/complete/poker",{templateUrl:"frontend/services/views/submit_service_2.html",controller:"submitServiceCtrl"}).when("/add-service/service-info/complete/exotic",{templateUrl:"frontend/services/views/submit_service_3.html",controller:"submitServiceCtrl"}).when("/add-service/service-info/complete/final",{templateUrl:"frontend/services/views/submit_service_4.html",controller:"submitServiceCtrl"}).when("/service-list",{templateUrl:"frontend/services/views/service_list.html",controller:"serviceCtrl"}).when("/document-verification",{templateUrl:"frontend/profile/views/dash_verification.html",controller:"profileCtrl",resolve:{validate:required}}).when("/my-booking",{templateUrl:"frontend/profile/views/dash_booking.html",controller:"profileCtrl",resolve:{validate:required}}).when("/transaction",{templateUrl:"frontend/profile/views/dash_transaction.html",controller:"profileCtrl",resolve:{validate:required}}).when("/messages",{templateUrl:"frontend/profile/views/dash_message.html",controller:"profileCtrl",resolve:{validate:required}}).when("/messages-detail",{templateUrl:"frontend/profile/views/dash_message_detail.html",controller:"profileCtrl"}).when("/reviews",{templateUrl:"frontend/profile/views/dash_reviews.html",controller:"profileCtrl",resolve:{validate:required}}).when("/dash-services",{templateUrl:"frontend/profile/views/dash_services.html",controller:"profileCtrl",resolve:{validate:required}}).when("/my-payment-preferences",{templateUrl:"frontend/payment/views/payment_preference.html",controller:"paymentPreferenceCtrl",resolve:{validate:required}}).when("/dash-booking-summary",{templateUrl:"frontend/profile/views/dash_booking_summary.html",controller:"profileCtrl",resolve:{validate:required}}).when("/search-listing",{templateUrl:"frontend/cms/views/search_listing.html",controller:"cmsCtrl"}).when("/search-listing-detail",{templateUrl:"frontend/cms/views/search_listing_detail.html",controller:"cmsCtrl"}).when("/detail-exotic-dancing",{templateUrl:"frontend/cms/views/detail_exotic_dancing.html",controller:"cmsCtrl"}).when("/availability-calendar",{templateUrl:"frontend/calendar/views/availability_calendar.html",controller:"calendarCtrl"}).when("/terms-of-use",{templateUrl:"frontend/cms/views/terms_use.html",controller:"cmsCtrl"}).when("/help-and-faq",{templateUrl:"frontend/cms/views/help_faq.html",controller:"cmsCtrl"}).when("/privacy-policy",{templateUrl:"frontend/cms/views/privacy_policy.html",controller:"cmsCtrl"}).when("/how-it-works",{templateUrl:"frontend/cms/views/howit_works.html",controller:"cmsCtrl"}).when("/about-us",{templateUrl:"frontend/cms/views/about_us.html",controller:"cmsCtrl"}).otherwise({redirectTo:"/"})}]);var required=["$q",function(e){var t=e.defer();return localStorage.getItem("userToken")?t.resolve():t.reject({authentication:!1}),t.promise}],notRequired=["$q",function(e){var t=e.defer();return localStorage.getItem("userToken")?t.reject({authentication:!0}):t.resolve(),t.promise}];app.factory("australia",["http",function(e){return{states:function(){return[{name:"Australian Capital Territory",Value:"ACT"},{name:"New South Wales",Value:"NSW"},{name:"Northern Territory",Value:"NT"},{name:"Queensland",Value:"QLD"},{name:"South Australia",Value:"SA"},{name:"Tasmania",Value:"TAS"},{name:"Victoria",Value:"VIC"},{name:"Western Australia",Value:"WA"}]}}}]),app.factory("http",["$http",function(e){return{get:function(t,n){return e.get(t).then(function(e){return{record:e.data}})},post:function(t,n){return e.post(t,n).then(function(e){return{result:e.data.success,message:e.data.message,data:e.data.record}},function(e){return{message:e.data.errors}})},login:function(t,n){return e.post(t,n).then(function(e){return{result:e.data.success,message:e.data.message,token:e.data.token,user:e.data.user}},function(e){return{message:e.data.errors}})},put:function(){},delete:function(){}}}]),app.factory("localData",[function(){return{token:function(){return localStorage.getItem("userToken")},data:function(){return JSON.parse(localStorage.getItem("user"))},removeItem:function(e){e.forEach(function(e){localStorage.removeItem(e)})},setUser:function(e){localStorage.setItem("user",JSON.stringify(e))}}}]),app.factory("timeout",["$timeout",function(e){return{sixHundredMiliSecond:function(t){e(function(){t()},600)}}}]),app.factory("toastyService",["toasty",function(e){return{notification:function(t,n){t===!0?e.success({title:"",msg:n,showClose:!0,clickToClose:!0,timeout:5e3,html:!0,theme:"bootstrap"}):t===!1&&e.error({title:"",msg:n,showClose:!0,clickToClose:!0,timeout:5e3,html:!0,theme:"bootstrap"})},logoutNotification:function(){e.success({title:"",msg:"You'have successfully logged out",showClose:!0,clickToClose:!0,timeout:5e3,html:!0,theme:"bootstrap"})}}}]),app.factory("socket",["$rootScope",function(e){var t=io.connect();return{on:function(e,n){t.on(e,n)},emit:function(e,n){t.emit(e,n)}}}]),app.controller("includesCtrl",["loginSignupPopup","$rootScope","socket","http","timeout","toastyService","localData","$scope","$location",function(e,t,n,o,r,i,a,s,l){!function(){s.profileInfo=a.data(),s.profileInfo&&s.profileInfo.image?s.imagePath=s.profileInfo.image:s.imagePath="assets/img/frontend/camra-icon.png"}(),s.userSignInfo={country_code:"+61"},s.dobMaxDate=new Date,s.loginSignup=function(t,n){console.log("loginSignup"),"login"==n?e.login(t):"signup"==n&&e.signup(t)},t.$on("callIncludesCtrl",function(e,t){s.imagePath=t}),n.emit("fist-test-socket",function(e){}),n.on("notification",function(e){}),s.fromFooterTo=function(e){l.path(e)},s.toPage=function(e){l.path(e)},s.logout=function(){var e=["userToken","user"];a.removeItem(e),r.sixHundredMiliSecond(function(){l.path("/"),i.logoutNotification()})},s.setClass=function(e,t){if(l.path().split("/")[1]==e)return!0},s.toggleAdvanceSearch=function(){$(".listing-srchTop").css("display","none"),$(".advancesrchBx").css("display","block")}}]),app.directive("numbersOnly",function(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){if(void 0===e)return"";var t=e.replace(/[^0-9]/g,"");return t!=e&&(o.$setViewValue(t),o.$render()),t})}}}),app.controller("landingCtrl",["loginSignupPopup","$scope","$location","$rootScope","$http","$mdDialog",function(e,t,n,o,r,i){t.toggleAdvanceSearch=function(){$(".listing-srchTop").css("display","none"),$(".advancesrchBx").css("display","block")},t.hideAdvanceSearch=function(){$(".advancesrchBx").css("display","none"),$(".listing-srchTop").css("display","block")},t.loginPopup=function(t){e.login(t)},t.signUpPopup=function(t){e.signup(t)}}]),app.factory("loginSignupPopup",["$mdDialog",function(e){return{login:function(t){e.show({controller:"loginSignupCtrl",templateUrl:"frontend/popup/views/login.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0}).then(function(e){},function(){})},signup:function(t){e.show({controller:"loginSignupCtrl",templateUrl:"frontend/popup/views/sign_up.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0}).then(function(e){},function(){})}}}]),app.controller("profileCtrl",["$log","$timeout","$q","australia","Upload","toastyService","localData","$scope","$location","$rootScope","http","$mdDialog",function(e,t,n,o,r,i,a,s,l,c,u,p){function f(){return g.suburbListArray.map(function(e){return{value:e.toLowerCase(),display:e}})}function d(e){var t=angular.lowercase(e);return function(e){return 0===e.value.indexOf(t)}}var g=this;!function(){s.user=a.data(),s.user.dob=new Date(s.user.dob),s.dobMaxDate=new Date,t(function(){s.stateChanged()},1e3),s.user.image?s.imagePath=s.user.image:s.imagePath="assets/img/frontend/camra-icon.png",s.statesArray=o.states()}(),s.oneAtATime=!0,s.groups=[{title:"Dynamic Group Header - 1",content:"Dynamic Group Body - 1"},{title:"Dynamic Group Header - 2",content:"Dynamic Group Body - 2"}],s.items=["Item 1","Item 2","Item 3"],s.addItem=function(){var e=s.items.length+1;s.items.push("Item "+e)},s.status={isCustomHeaderOpen:!1,isFirstOpen:!0,isFirstDisabled:!1},s.leaveReviewPopup=function(e){p.show({controller:"includesCtrl",templateUrl:"frontend/popup/leave_review.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0}).then(function(e){s.status='You said the information was "'+e+'".'},function(){s.status="You cancelled the dialog."})},s.updateProfile=function(){var e=angular.copy(s.user);["country_code","updated_at","created_at"].forEach(function(t){delete e[t]}),e.subrub=e.subrub.display,u.post("/update-user-profile",e).then(function(e){i.notification(e.result,e.message),e.result&&a.setUser(s.user)})},s.myImage="",s.myCroppedImage="",s.selectFile=function(e,t){var n=["image/jpeg","image/jpg","image/png"];if(e&&n.indexOf(e.type)===-1)return void i.notification(!1,"You can only upload image having file extension jpg, jpeg or png");g.filename=e?e.name:"";var o=new FileReader;o.onload=function(e){s.$apply(function(n){n.myImage=e.target.result,t&&n.cropImagePopup()})},o.readAsDataURL(e)},s.uploadProfileImage=function(e,t){var n={dataUrl:e,imageName:g.filename};r.upload({url:"update-user-profile-image",data:{file:r.dataUrltoBlob(n.dataUrl,n.imageName)}}).then(function(e){i.notification(e.data.success,e.data.message),s.closeImageDialog(),e.data.success&&(s.imagePath=e.data.url,s.user.image=s.imagePath,a.setUser(s.user),c.$emit("callIncludesCtrl",s.imagePath))})},s.cropImagePopup=function(){p.show({contentElement:"#imageDialog",parent:angular.element(document.body),clickOutsideToClose:!0})},s.closeImageDialog=function(){s.myImage="",p.hide()},s.stateChanged=function(){u.get("/get-suburb-list?state="+s.user.state).then(function(e){g.suburbListArray=e.record.data,g.states=f()})},s.querySearch=function(e){var o,r=e?g.states.filter(d(e)):g.states;return g.simulateQuery?(o=n.defer(),t(function(){o.resolve(r)},1e3*Math.random(),!1),o.promise):r},s.searchTextChange=function(e){}}]),app.controller("serviceProviderCtrl",["$scope",function(e){console.log("hello service provider ctlr")}]),app.controller("cmsCtrl",["localData","$scope","$location","$mdDialog",function(e,t,n,o){t.toggleAdvanceSearch=function(){$(".listing-srchTop").css("display","none"),$(".advancesrchBx").css("display","block")},t.hideAdvanceSearch=function(){$(".advancesrchBx").css("display","none"),$(".listing-srchTop").css("display","block")},t.cancelRequestPopup=function(e){console.log("CANCEL POP"),o.show({controller:"loginSignupCtrl",templateUrl:"frontend/popup/cancel_request.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0}).then(function(e){},function(){})},t.addBookingPopup=function(e){console.log("ADD BOOKING"),o.show({controller:"loginSignupCtrl",templateUrl:"frontend/popup/add_booking.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0}).then(function(e){},function(){})}}]),app.controller("settingsCtrl",["$scope","http","localData","toastyService",function(e,t,n,o){!function(){e.profileInfo=n.data(),e.active={isActive:e.profileInfo.isActive},e.notification={enableNotification:e.profileInfo.enableNotification}}(),e.changePassword=function(){e.userPassword._id=e.profileInfo._id,t.post("/change-password",e.userPassword).then(function(t){o.notification(t.result,t.message),t.result&&(e.userPassword={},e.changePasswordForm.$setPristine(),e.changePasswordForm.$setUntouched())})},e.activeInactive=function(){e.active._id=e.profileInfo._id,t.post("/is-active",e.active).then(function(t){o.notification(t.result,t.message),e.profileInfo.isActive=e.active.isActive,n.setUser(e.profileInfo)})},e.activeInactiveNotification=function(){e.notification._id=e.profileInfo._id,t.post("/notification-setting",e.notification).then(function(t){o.notification(t.result,t.message),e.profileInfo.enableNotification=e.notification.enableNotification,n.setUser(e.profileInfo)})}}]),app.controller("referCtrl",["$scope","http","toastyService",function(e,t,n){e.referToFriend=function(){e.buttonStatus=!0,t.get("/refer-to-friend/"+e.friend.email).then(function(t){n.notification(t.record.success,t.record.message),e.buttonStatus=!1,t.record.success&&(e.friend={},e.referringForm.$setPristine(),e.referringForm.$setUntouched())})}}]),app.controller("serviceCtrl",["$scope","http","$location","toastyService","$cookies",function(e,t,n,o,r){function i(e){var t=".temp-class"+e;$(t).hasClass("selected-category")?$(t).removeClass("selected-category"):$(t).addClass("selected-category")}!function(){t.get("/category-service-list").then(function(t){e.dataArray=t.record.result})}();var a=[];e.selectCategory=function(e,t){i(t);var n=a.indexOf(e);n===-1?a.push(e):a.splice(n,1)},e.addCategory=function(){if(r.put("categoryArray",a),a.length>0){var e=a[0].toLowerCase(),t=e.indexOf(" ");t>0&&(e=e.substr(0,t)),n.path("/add-services/service-info/complete/")}else o.notification(!1,"Please select category")}}]),app.controller("submitServiceCtrl",["toastyService","$location","$scope","http","$cookies",function(e,t,n,o,r){function i(){var e=r.get("categoryArray").split(",");n.SELECTDIV={WAITRESS:e.indexOf("WAITRESS")>=0,POKER:e.indexOf("POKER DEALING")>=0,EXOTIC:e.indexOf("EXOTIC DANCING")>=0}}function a(){var e=[];if(!angular.equals(n.waitress,{})){var t={waitress:n.waitress};e.push(t)}if(!angular.equals(n.poker,{})){var r={poker:n.poker};e.push(r)}if(n.SELECTDIV.EXOTIC){var i={exotics:n.exotics};e.push(i)}var a={travel_distance:n.travel_distance,category:e};o.post("/save-category-data",a).then(function(e){console.log(e)})}!function(){n.exotics=[{id:1}],n.service={},n.waitress={},n.poker={},o.get("/category-service-list").then(function(e){n.dataArray=e.record.result,n.categoryTitle=n.dataArray.category.map(function(e){return e.title})}),i()}(),n.addNewChoice=function(){var e=n.exotics.length+1;n.exotics.push({id:e})},n.removeChoice=function(e){n.exotics.splice(e,1)},n.checkWaitressSelection=function(e){0===n.waitress[e].type&&delete n.waitress[e]},n.checkPokerSelection=function(e){0===n.poker[e].type&&delete n.poker[e]},n.submitData=function(){return n.SELECTDIV.WAITRESS&&angular.equals(n.waitress,{})?void e.notification(!1,"Please select waitress service information"):n.SELECTDIV.POKER&&angular.equals(n.poker,{})?void e.notification(!1,"Please select poker service information"):void a()}}]),app.controller("paymentPreferenceCtrl",["$scope",function(e){console.log("paymentPreferenceCtrl")}]),app.controller("loginSignUpCtrl",["$cookies","http","toastyService","loginSignupPopup","$mdDialog","$scope","$location","$rootScope","$http",function(e,t,n,o,r,i,a,s,l){i.showscrollbar=!0,function(){e.get("userLoginCredentials")&&(i.userLogin=JSON.parse(e.get("userLoginCredentials")),i.rememberMeStatus=!0)}(),i.userSignInfo={country_code:"+61"},i.dobMaxDate=new Date,i.loginSignup=function(e,t){"login"==t?o.login(e):"signup"==t&&o.signup(e)},i.signUp=function(){i.userSignInfo.password!==i.userSignInfo.cpassword?n.notification(!1,"Password and confirm password is not equal"):i.userSignInfo.is_agree?t.post("/user-signup",i.userSignInfo).then(function(e){n.notification(e.result,e.message),e.result&&i.closeMe()}):n.notification(!1,"Please accept terms and conditions.")},i.closeMe=function(){r.hide()},i.rememberMe=function(){i.rememberMeStatus?e.put("userLoginCredentials",JSON.stringify(i.userLogin)):e.remove("userLoginCredentials")}}]),app.controller("calendarCtrl",["$scope",function(e){function t(){e.mm=[],e.hh=[];for(var t=1;t<=60;t++)e.mm.push(t),t<=12&&e.hh.push(t)}!function(){e.myDate=new Date,e.minDate=new Date(e.myDate.getFullYear(),e.myDate.getMonth(),e.myDate.getDate()),e.calendar={start_date:new Date(e.minDate),end_date:new Date(e.minDate)},t()}(),e.setAvailabity=function(){console.log(e.calendar)}}]),app.controller("loginSignupCtrl",["$cookies","http","toastyService","loginSignupPopup","$mdDialog","$scope","$location","$rootScope","$http",function(e,t,n,o,r,i,a,s,l){!function(){e.get("userLoginCredentials")&&(i.userLogin=JSON.parse(e.get("userLoginCredentials")),i.rememberMeStatus=!0)}(),i.userSignInfo={country_code:"+61"},i.dobMaxDate=new Date,i.loginSignup=function(e,t){"login"==t?o.login(e):"signup"==t&&o.signup(e)},i.signUp=function(){i.userSignInfo.password!==i.userSignInfo.cpassword?n.notification(!1,"Password and confirm password is not equal"):i.userSignInfo.is_agree?t.post("/user-signup",i.userSignInfo).then(function(e){n.notification(e.result,e.message),e.result&&i.closeMe()}):n.notification(!1,"Please accept terms and conditions.")},i.login=function(){t.login("/user-login",i.userLogin).then(function(e){e.result===!0?(localStorage.setItem("userToken",e.token),localStorage.setItem("user",JSON.stringify(e.user)),i.closeMe(),a.path("/my-profile")):n.notification(e.result,e.message)})},i.closeMe=function(){r.hide()},i.rememberMe=function(){i.rememberMeStatus?e.put("userLoginCredentials",JSON.stringify(i.userLogin)):e.remove("userLoginCredentials")}}]);